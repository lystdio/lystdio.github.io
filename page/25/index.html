<!DOCTYPE html>












  


<html class="theme-next mist use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
































<link href="/blog/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/blog/css/main.css?v=6.6.0" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/blog/images/apple-touch-icon-next.png?v=6.6.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/blog/images/favicon-32x32-next.png?v=6.6.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/blog/images/favicon-16x16-next.png?v=6.6.0">


  <link rel="mask-icon" href="/blog/images/logo.svg?v=6.6.0" color="#222">









<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/blog/',
    scheme: 'Mist',
    version: '6.6.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta property="og:type" content="website">
<meta property="og:title" content="撼地神牛">
<meta property="og:url" content="https://handishenniu.coding.me/blog/page/25/index.html">
<meta property="og:site_name" content="撼地神牛">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="撼地神牛">






  <link rel="canonical" href="https://handishenniu.coding.me/blog/page/25/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>撼地神牛</title>
  






  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?304ebec1c594afeac3282f7afb1f3448";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>







  <noscript>
  <style>
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion .logo-line-before i { left: initial; }
    .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

  <meta name="baidu-site-verification" content="mI6O7pmEdr">
</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>
    
    
    
    <a href="https://github.com/lystdio" target="_blank"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub"></a>
    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/blog/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">撼地神牛</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/blog/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/blog/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/blog/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/blog/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-sitemap">

    
    
    
      
    

    

    <a href="/blog/sitemap.xml" rel="section"><i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br>站点地图</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/blog/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>关于</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>搜索</a>
        </li>
      
    </ul>
  

  
    

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    
  
  
  
  

  

    <a href="https://github.com/lystdio" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewbox="0 0 250 250" style="fill: #222; color: #fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a>



    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://handishenniu.coding.me/blog/blog/2013/05/14/2013-05-14-cb-four-method-to-Asynchronous/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lion">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="撼地神牛">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/blog/2013/05/14/2013-05-14-cb-four-method-to-Asynchronous/" class="post-title-link" itemprop="https://handishenniu.coding.me/blog/page/25/index.html">实现Javascript异步编程的4种方法</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2013-05-14 02:52:00" itemprop="dateCreated datePublished" datetime="2013-05-14T02:52:00+08:00">2013-05-14</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-12-12 18:10:11" itemprop="dateModified" datetime="2018-12-12T18:10:11+08:00">2018-12-12</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/blog/categories/JavaScript/" itemprop="url" rel="index"><span itemprop="name">JavaScript</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/blog/categories/JavaScript/剪贴板/" itemprop="url" rel="index"><span itemprop="name">剪贴板</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <div class="history-article">本文为归档内容,原始地址在 <a href="http://www.cnblogs.com/hustskyking/archive/2013/05/14/four-method-to-Asynchronous.html" target="_blank">博客园</a>.</div>

<p><span>你可能知道，Javascript语言的执行环境是<span>“单线程”</span>（single thread）。</span></p><br><blockquote><br><p>所谓”单线程”，就是指一次只能完成一件任务。如果有多个任务，就必须排队，前面一个任务完成，再执行后面一个任务，以此类推。</p><br></blockquote><br><p><span>这种模式的<strong><span>好处</span></strong>是实现起来比较简单，执行环境相对单纯；<strong><span>坏处</span></strong>是只要有一个任务耗时很长，后面的任务都必须排队等着，会拖延整个程序的执行。常见的浏览器无响应（假死），往往就是因为某一段Javascript代码长时间运行（比如死循环），导致整个页面卡在这个地方，其他任务无法执行。</span></p>


<p><span>为了解决这个问题，<span>Javascript语言将任务的执行模式分成两种：同步（Synchronous）和异步（Asynchronous）</span>。</span></p><br><ul><br><li><span>“同步模式”就是上一段的模式，后一个任务等待前一个任务结束，然后再执行，程序的执行顺序与任务的排列顺序是一致的、同步的；”异步模式”则完全不同，每一个任务有一个或多个回调函数（callback），前一个任务结束后，不是执行后一个任务，而是执行回调函数，后一个任务则是不等前一个任务结束就执行，所以程序的执行顺序与任务的排列顺序是不一致的、异步的。</span></li><br><li><span>“异步模式”非常重要。在浏览器端，耗时很长的操作都应该异步执行，避免浏览器失去响应，最好的例子就是Ajax操作。在服务器端，”异步模式”甚至是唯一的模式，因为执行环境是单线程的，如果允许同步执行所有http请求，服务器性能会急剧下降，很快就会失去响应。</span></li><br></ul><br><p><span>本文总结了”异步模式”编程的4种方法，理解它们可以让你写出结构更合理、性能更出色、维护更方便的Javascript程序。</span></p>


<p><strong><span>一、回调函数</span></strong></p><br><p><span>这是异步编程最基本的方法。</span></p><br><p><span>假定有两个函数f1和f2，后者等待前者的执行结果。</span></p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">f1();</span><br><span class="line">f2();</span><br></pre></td></tr></table></figure>
<p><span>如果f1是一个很耗时的任务，可以考虑改写f1，把f2写成f1的回调函数。</span></p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">function f1(callback)&#123;</span><br><span class="line">    setTimeout(function () &#123;</span><br><span class="line">    // f1的任务代码</span><br><span class="line">        callback();</span><br><span class="line">    &#125;, 1000);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><span>执行代码就变成下面这样：</span></p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">f1(f2); //回调</span><br></pre></td></tr></table></figure>
<p><span>采用这种方式，我们把同步操作变成了异步操作，f1不会堵塞程序运行，相当于先执行程序的主要逻辑，将耗时的操作推迟执行。</span></p><br><p><span>回调函数的优点是简单、容易理解和部署，缺点是不利于代码的阅读和维护，各个部分之间高度耦合（Coupling），流程会很混乱，而且每个任务只能指定一个回调函数。</span></p>


<p><strong><span>二、事件监听</span></strong></p><br><p><span>另一种思路是采用事件驱动模式。任务的执行不取决于代码的顺序，而取决于某个事件是否发生。</span></p><br><p><span>还是以f1和f2为例。首先，为f1绑定一个事件（这里采用的jQuery的写法）。</span></p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">f1.on(&apos;done&apos;, f2);</span><br></pre></td></tr></table></figure>
<p><span>上面这行代码的意思是，当f1发生done事件，就执行f2。然后，对f1进行改写：</span></p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">function f1()&#123;</span><br><span class="line">    setTimeout(function () &#123;</span><br><span class="line">    // f1的任务代码</span><br><span class="line">        f1.trigger(&apos;done&apos;);</span><br><span class="line">    &#125;, 1000);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><span>f1.trigger(‘done’)表示，执行完成后，立即触发done事件，从而开始执行f2。</span></p><br><p><span>这种方法的优点是比较容易理解，可以绑定多个事件，每个事件可以指定多个回调函数，而且可以”去耦合”（Decoupling），有利于实现模块化。缺点是整个程序都要变成事件驱动型，运行流程会变得很不清晰。</span></p>


<p><strong><span>三、发布/订阅</span></strong></p><br><p><span>我们假定，存在一个”信号中心”，某个任务执行完成，就向信号中心”发布”（publish）一个信号，其他任务可以向信号中心”订阅”（subscribe）这个信号，从而知道什么时候自己可以开始执行。这就叫做”发布/订阅模式”（publish-subscribe pattern），又称”观察者模式”（observer pattern）。</span></p><br><p><span>这个模式有多种实现，下面采用的是Ben Alman的Tiny Pub/Sub，这是jQuery的一个插件。</span></p><br><p><span>首先，f2向”信号中心”jQuery订阅”done”信号。</span></p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jQuery.subscribe(&quot;done&quot;, f2);</span><br></pre></td></tr></table></figure>
<p><span>然后，f1进行如下改写：</span></p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">function f1()&#123;</span><br><span class="line">    setTimeout(function () &#123;</span><br><span class="line">    // f1的任务代码</span><br><span class="line">        jQuery.publish(&quot;done&quot;);</span><br><span class="line">    &#125;, 1000);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><span>jQuery.publish(“done”)的意思是，f1执行完成后，向”信号中心”jQuery发布”done”信号，从而引发f2的执行。</span></p><br><p><span>此外，f2完成执行后，也可以取消订阅（unsubscribe）。</span></p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jQuery.unsubscribe(&quot;done&quot;, f2);</span><br></pre></td></tr></table></figure>
<p><span>这种方法的性质与”事件监听”类似，但是明显优于后者。因为我们可以通过查看”消息中心”，了解存在多少信号、每个信号有多少订阅者，从而监控程序的运行。</span></p>


<p><strong><span>四、Promises对象</span></strong></p><br><p>Promises对象是<a title="commonJS" href="http://en.wikipedia.org/wiki/CommonJS" target="_blank">CommonJS</a>工作组提出的一种规范，目的是为异步编程提供统一接口。</p><br><p><span>简单说，它的思想是，每一个异步任务返回一个Promise对象，该对象有一个then方法，允许指定回调函数。比如，f1的回调函数f2,可以写成：</span></p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">f1().then(f2);</span><br></pre></td></tr></table></figure>
<p><span>f1要进行如下改写（这里使用的是jQuery的实现）：</span></p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">function f1()&#123;</span><br><span class="line">    var dfd = $.Deferred();</span><br><span class="line">    setTimeout(function () &#123;</span><br><span class="line">    // f1的任务代码</span><br><span class="line">        dfd.resolve();</span><br><span class="line">    &#125;, 500);</span><br><span class="line">    return dfd.promise;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><span>这样写的优点在于，回调函数变成了链式写法，程序的流程可以看得很清楚，而且有一整套的配套方法，可以实现许多强大的功能。</span></p><br><p><span>比如，指定多个回调函数：</span></p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">f1().then(f2).then(f3);</span><br></pre></td></tr></table></figure>
<p><span>再比如，指定发生错误时的回调函数：</span></p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">f1().then(f2).fail(f3);</span><br></pre></td></tr></table></figure>
<p><span>而且，它还有一个前面三种方法都没有的好处：<span>如果一个任务已经完成，再添加回调函数，该回调函数会立即执行。</span>所以，你不用担心是否错过了某个事件或信号。<span>这种方法的缺点就是编写和理解，都相对比较难。</span></span></p>


<p><strong><span>五、参考链接</span></strong></p><br><p><span><span><em>&nbsp;<a href="http://sporto.github.com/blog/2012/12/09/callbacks-listeners-promises/" rel="noopener" target="_blank">Asynchronous JS: Callbacks, Listeners, Control Flow Libs and Promises</a></em></span></span></p><br><p><span><span><span>&nbsp;</span><a href="http://www.ruanyifeng.com/blog/2012/12/asynchronous%EF%BC%BFjavascript.html" target="_blank" rel="noopener">http://www.ruanyifeng.com/blog/2012/12/asynchronous＿javascript.html</a></span></span></p>


          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://handishenniu.coding.me/blog/blog/2013/05/05/2013-05-05-cb-getKeywords-2/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lion">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="撼地神牛">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/blog/2013/05/05/2013-05-05-cb-getKeywords-2/" class="post-title-link" itemprop="https://handishenniu.coding.me/blog/page/25/index.html">Javascript综合应用小案例（续）</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2013-05-05 12:41:00" itemprop="dateCreated datePublished" datetime="2013-05-05T12:41:00+08:00">2013-05-05</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-12-12 18:10:11" itemprop="dateModified" datetime="2018-12-12T18:10:11+08:00">2018-12-12</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/blog/categories/JavaScript/" itemprop="url" rel="index"><span itemprop="name">JavaScript</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/blog/categories/JavaScript/杂物间/" itemprop="url" rel="index"><span itemprop="name">杂物间</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <div class="history-article">本文为归档内容,原始地址在 <a href="http://www.cnblogs.com/hustskyking/archive/2013/05/05/getKeywords-2.html" target="_blank">博客园</a>.</div>

<p><a class="titlelink" href="http://www.cnblogs.com/hustskyking/archive/2013/05/04/getkeywords.html" target="_blank" rel="noopener">上一篇文章</a>，弄了一个 <strong>取词&nbsp;</strong>和 <strong>标红</strong> 功能的小应用，但是存在一些bug，今天修修补补，顺便也把ajax部分补上了~</p><br><p><a href="http://qianduannotes.sinaapp.com/getKeyword/" target="_blank"><img src="//img.alicdn.com/tfs/TB1oyqGa_tYBeNjy1XdXXXXyVXa-300-300.png" data-original="/blogimgs/2013/05/05/04235938-51987cdb332f4539bbfbeeb88d093e1c.png" data-source="http://images.cnitblog.com/blog/387325/201305/04235938-51987cdb332f4539bbfbeeb88d093e1c.png" alt="" width="850" height="408"></a></p>


<p>Demo地址：<span>：</span><a title="取词&&标红 demo" href="http://qianduannotes.sinaapp.com/getKeyword/" target="_blank">http://qianduannotes.sinaapp.com/getKeyword/</a></p>


<p>代码部分：</p><br><div class="cnblogs_Highlighter"><br><pre class="brush:javascript;collapse:true;;gutter:false;">var GetKeywords = {<br>  str: “”,<br>  limit: 11,<br>  keywords:[],<br>  url: “./tool.php”,<br><br>  //page id<br>  getId: function(){<br>    this.id = this.<em>(“wp”).getAttribute(“data-page”);<br>  },<br><br>  init : function(){<br>    var box = this.</em>(“article”),<br>      _this = this;<br><br>    //获取已经存在的关键词<br>    this.getAllKeyWord();<br>    //获取页面ID<br>    this.getId();<br>    //让rmKeyWord函数全局化<br>    window.rmkeyWord = this.rmkeyWord;<br><br>    //取词事件<br>    box.onmouseup = function(evt){<br>      var evt = evt || window.event,<br>        target = evt.target || evt.srcElement;<br><br>      //如果鼠标是在button上弹起，则忽略<br>      if(target.id == “btn”) return;<br>      GetKeywords.str = _this.getSelectionText();<br><br>      if(_this.str.length == 0){<br>        _this.removeBtn();<br>        return;<br>      }<br>      if(<em>this.</em>(“btn”)) {<br>        _this.removeBtn();<br>        if(GetKeywords.str == “”) return;<br>        _this.createBtn(evt);<br>        return;<br>      }<br>      _this.createBtn(evt);<br>    }<br><br>    var types = document.getElementsByTagName(“input”);<br>    for(var j = 0, len = types.length; j &lt; len; j++){<br>      (function(j){<br>        types[j].onchange = function(){<br>          _this.sendData(j + 1, “change”);<br>        }<br>      })(j);<br>    }<br>  },<br><br>  //工具函数<br>  _: function(obj){<br>    return document.getElementById(obj);<br>  },<br><br>  //获取选中文本<br>  getSelectionText: function(){<br>    if(window.getSelection) {<br>      return window.getSelection().toString();<br>    } else if(document.selection &amp;&amp; document.selection.createRange) {<br>      return document.selection.createRange().text;<br>    }<br>    return ‘’;<br>  },<br><br>  //创建按钮<br>  createBtn: function(evt){<br>    var button = document.createElement(“div”),<br>      evt = evt || window.event,<br>      x = evt.pageX || evt.x,<br>      y = evt.pageY || evt.y,<br>      i, j, len,<br>      cssList = “”,<br>      <em>this = this,<br>      csses = {<br>        “height” : “30px”,<br>        “line-height” : “30px”,<br>        “position”: “absolute”,<br>        “top”: y + 10 + “px”,<br>        “left”: x + 10 + “px”,<br>        “cursor”: “pointer”,<br>        “border”: “1px solid #000”,<br>        “background”: “#EEE”,<br>        “padding”: “2px 8px”,<br>        “border-radius”: “3px”<br>      };<br>    for(i in csses){<br>      if(csses.hasOwnProperty(i)){<br>        cssList += i + “:” + csses[i] + “;”;<br>      }<br>    }<br>    button.style.cssText = cssList;<br>    button.innerHTML = “添加到关键词列表”;<br>    button.setAttribute(“id”, “btn”);<br><br>    this.</em>(“article”).appendChild(button);<br><br>    button.onclick = function(){<br>      if(_this.str.length &gt; _this.limit){<br>        alert(“关键词长度最长为11，可以通过设置GetKeywords.limit来控制长度。”);<br>        _this.removeBtn();<br>        return;<br>      }<br><br>      for(j = 0, len = GetKeywords.keywords.length; j &lt; len; j++){<br>        if(GetKeywords.keywords[j] == _this.str){<br>          alert(“已经存在该关键词了~”);<br>          _this.removeBtn();<br>          return;<br>        }<br>        continue;<br>      }<br><br>      _this.sendData(_this.str);<br><br>      _this.keywords.push(_this.str);<br>      _this.setRed(_this.str);<br>      _this.addTo();<br><br>      <em>this.removeBtn();<br>    };<br>  },<br><br>  //删除按钮<br>  removeBtn: function(){<br>    var btn = this.</em>(“btn”);<br>    btn.parentNode.removeChild(btn);<br>  },<br><br>  //加入到关键词里列表<br>  addTo: function(){<br>    var word = this.<em>(“wordList”);<br>    word.innerHTML += “&lt;span&gt;&lt;font&gt;” + this.str + “&lt;/font&gt;&lt;a href=’#’ onclick=’rmkeyWord(this);’&gt;&lt;/a&gt;&lt;/span&gt;”;<br>  },<br><br>  //关键词标红<br>  setRed: function(str){<br>    var content = this.</em>(“article”),<br>      temp = ‘(‘ + str + ‘)’;<br>      reg = new RegExp(temp,’g’);<br><br>    content.innerHTML = content.innerHTML.replace(reg, “&lt;span style=’color:red;’&gt;$1&lt;/span&gt;”);<br>  },<br><br>  //删除标红<br>  rmRed: function(str){<br>    var content = this.<em>(“article”),<br>      temp = “(&lt;span[^&lt;]*” + str + “&lt;/span&gt;)”;<br>      reg = new RegExp(temp,’gi’);<br>    content.innerHTML = content.innerHTML.replace(reg, str);<br>  },<br><br>  //获取已经存在的关键词（也可以用来获取所有关键词）<br>  getAllKeyWord: function (){<br>    var spans = this.</em>(“wordList”).getElementsByTagName(“span”),<br>      key = [], i = 0, len;<br>    for(len = spans.length; i &lt; len; i++){<br>      var font = spans[i].getElementsByTagName(“font”)[0];<br>      var temp = font.innerText || font.textContent;<br>      this.setRed(temp);<br>      key.push(temp);<br>    }<br>    this.keywords = key;<br>  },<br><br>  //删除关键词<br>  rmkeyWord: function (obj){<br>    var target = obj.parentNode,<br>      word = obj.previousSibling.innerHTML,<br>      i = 0, len;<br><br>    res = GetKeywords.sendData(word, “del”);<br><br>    GetKeywords.rmRed(word);<br>    for(len = GetKeywords.keywords.length; i &lt; len; i++){<br>      if(GetKeywords.keywords[i] == word){<br>        GetKeywords.keywords.splice(i,i);<br>      }<br>      continue;<br>    }<br>    target.parentNode.removeChild(target);<br>    var evt = arguments.callee.caller.arguments[0];<br>    try{<br>      evt.preventDefault();<br>    }catch(e){<br>      window.event.returnValue = false;<br>    }<br>  },<br><br>  //ajax<br>  sendData: function(data, action){<br>    var xmlhttp,<br>      action = action || “add”,<br>      _this = this;<br>    if (window.XMLHttpRequest){<br>      xmlhttp = new XMLHttpRequest();<br>    }else{<br>      xmlhttp = new ActiveXObject(“Microsoft.XMLHTTP”);<br>    }<br>    xmlhttp.open(“GET”, this.url + “?” + action + “=” + data + “&lt;id=” + this.id, true);<br>    xmlhttp.onreadystatechange = function(){<br>      if (xmlhttp.readyState == 4 &amp;&amp; xmlhttp.status == 200){<br>        _this.sendSuccess(xmlhttp.responseText);<br>      }<br>    }<br>    xmlhttp.send();<br><br>  },<br><br>  sendSuccess:function(data){<br>    window.console &amp;&amp; window.console.log &amp;&amp; window.console.log(data);<br>  }<br>}<br><br>GetKeywords.init();<br></pre><br></div><br><p>　　</p><br><p><strong>一、ajax部分</strong></p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">sendData: function(data, action)&#123;</span><br><span class="line">    var xmlhttp,</span><br><span class="line">        action = action || &quot;add&quot;,</span><br><span class="line">        _this = this;</span><br><span class="line">    if (window.XMLHttpRequest)&#123;</span><br><span class="line">        xmlhttp = new XMLHttpRequest();</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        xmlhttp = new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    xmlhttp.open(&quot;GET&quot;, this.url + &quot;?&quot; + action + &quot;=&quot; + data + &quot;&lt;id=&quot; + this.id, true);</span><br><span class="line">    xmlhttp.onreadystatechange = function()&#123;</span><br><span class="line">        if (xmlhttp.readyState == 4 &amp;&amp; xmlhttp.status == 200)&#123;</span><br><span class="line">            _this.sendSuccess(xmlhttp.responseText);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    xmlhttp.send();</span><br><span class="line"></span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line">sendSuccess:function(data)&#123;</span><br><span class="line">    window.console &amp;&amp; window.console.log &amp;&amp; window.console.log(data);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>感觉这里真心就没什么好说的，因为这玩意儿涉及到数据的提交、删除、和更新，所以GET的状态也分为add、del、change。</p><br><p>默认的提交状态是add，代码中已经标红。</p>


<p><strong>二、删除关键词</strong></p><br><p>上次也说了这个部分，但是里边用到了一个splice，在这里稍微详细描述下。</p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">rmkeyWord: function (obj)&#123;</span><br><span class="line">    var target = obj.parentNode,</span><br><span class="line">        word = obj.previousSibling.innerHTML,</span><br><span class="line">        i = 0, len;</span><br><span class="line"></span><br><span class="line">    res = GetKeywords.sendData(word, &quot;del&quot;);</span><br><span class="line"></span><br><span class="line">    GetKeywords.rmRed(word);</span><br><span class="line">    for(len = GetKeywords.keywords.length; i &lt; len; i++)&#123;</span><br><span class="line">        if(GetKeywords.keywords[i] == word)&#123;</span><br><span class="line">            GetKeywords.keywords.splice(i,i); //删除第i个元素</span><br><span class="line">        &#125;</span><br><span class="line">        continue;</span><br><span class="line">    &#125;</span><br><span class="line">    target.parentNode.removeChild(target);</span><br><span class="line">    var evt = arguments.callee.caller.arguments[0];</span><br><span class="line">    try&#123;</span><br><span class="line">        evt.preventDefault();</span><br><span class="line">    &#125;catch(e)&#123;</span><br><span class="line">        window.event.returnValue = false;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<p><span>splice() 方法用于插入、删除或替换数组的元素。</span></p><br><p><span><span>这个方法可删除从 index 处开始的零个或多个元素，并且用参数列表中声明的一个或多个值来替换那些被删除的元素。</span></span></p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arrayObject.splice(index,howmany,element1,.....,elementX)</span><br></pre></td></tr></table></figure>
<p><table class="dataintable"></table></p>
<p><tbody></tbody></p>
<p><tr><th>参数</th><th>描述</th></tr></p>
<p><tr></tr></p>
<p><td>index</td></p>
<p><td></td></p>
<p>必需。规定从何处添加/删除元素。</p><br><p>该参数是开始插入和（或）删除的数组元素的下标，必须是数字。</p><br><br><br><tr><br><td>howmany</td><br><td><br><p>必需。规定应该删除多少元素。必须是数字，但可以是 “0”。</p><br><p>如果未规定此参数，则删除从 index 开始到原数组结尾的所有元素。</p><br></td><br></tr><br><tr><br><td>element1</td><br><td>可选。规定要添加到数组的新元素。从 index 所指的下标处开始插入。</td><br></tr><br><tr><br><td>elementX</td><br><td>可选。可向数组添加若干元素。</td><br></tr><br><br><br><p>1）插入</p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ArrayObj.splice(2, 0, &quot;addObj&quot;);</span><br></pre></td></tr></table></figure>
<p>即为在数组第三个位置插入一个名为\addObj”的字符串。</p>


<p>2）删除</p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ArrayObj.splice(2, 2);</span><br></pre></td></tr></table></figure>
<p>即为删除从第三个开始的连续两个数组元素。</p>


<p>3）插入</p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ArrayObj.splice(2, 1，&quot;replaceObj&quot;);</span><br></pre></td></tr></table></figure>
<p>即为替换第三个元素（也可以说是删除从第三个元素开始的连续一个元素，然后添加一个名为\replaceObj”的字符串）。</p>


<p>来一个综合应用的：</p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ArrayObj.splice(2, 2，&quot;replaceObj_1&quot;，&quot;replaceObj_2&quot;);</span><br></pre></td></tr></table></figure>
<p>&nbsp;即为删除从第三个元素开始的连续两个元素，然后在刚才删除的位置，添加名为\replaceObj_1”，\replaceObj_2”的两个字符串。相信应该已经比较清楚了吧~O(&cap;_&cap;)O~</p><br><p><em>注：splice() 方法与 slice() 方法的作用是不同的，splice() 方法会直接对数组进行修改。</em></p>


<p><strong>三、遇到的问题</strong></p><br><p><strong>1. this指定的对象</strong></p><br><p>对象方法中this并不一定指向对象本身，即使写了</p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">f: function()&#123;</span><br><span class="line">    var _this = this; //然后在闭包中使用_this</span><br><span class="line">    function name()&#123;</span><br><span class="line">        _this.doSomething();//这是的_this也不一定是对象本身</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这是_this也不一定是指向该对象，[object global]，有可能指向的是这个对象~</p>


<p><strong>2. event的兼容性</strong></p><br><p>相信evt = evt || window.event，大家都明白，但是在FF下：</p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function test(evt)&#123;</span><br><span class="line">    var evt = evt || window.event;</span><br><span class="line">    //...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在调用test()的时候，如果没有加参数，evt为undefined，使用过程需要test(evt);当然也可以这样:</p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function test()&#123;</span><br><span class="line">    var evt = argument.callee.caller.argument[0];</span><br><span class="line">    //...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>4. for-in的问题</strong></p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">for(i in csses)&#123;</span><br><span class="line">    if(csses.hasOwnProperty(i))&#123;</span><br><span class="line">        cssList += i + &quot;:&quot; + csses[i] + &quot;;&quot;;　　　　 //button.style[i] = csses[i];　　 &#125; &#125; button.style.cssText = cssList;</span><br></pre></td></tr></table></figure>
<p>开始的时候，我用的是注释里的方法button.style[i] = csses[i]，但在IE下报错了，后来就用的上面方式实现，具体为什么我也不知道。。</p>


<p><strong>5. 标签解析的问题</strong></p><br><p>IE载入DOM之后，会把所有的标签解析成大写的，这个至少在IE7和8是如此，IE9以上没测试，就不知道了~</p>


<p><strong>6. JS一些常见的浏览器兼容问题</strong></p><br><p>这里提到的有：</p><br><ul><br><li>evt || window.event</li><br><li>evt.target || evt.srcElement</li><br><li>evt.x || evt.pageX || evt.layerX</li><br><li>evt.preventDefault() Vs window.event.returnValue = false</li><br><li>XMLHttpRequest ||&nbsp;ActiveXObject(“Microsoft.XMLHTTP”)</li><br><li>obj.innerText || obj.textContent</li><br><li>window.getSelection ||　document.selection</li><br></ul><br><br><br><p><strong>四、参考</strong></p><br><ul><br><li><a title="splice" href="http://www.w3school.com.cn/js/jsref_splice.asp" target="_blank">W3School splice</a></li><br></ul><br><br><br><p><strong>五、结语</strong></p><br><p><strong>我</strong>认为，对象里的数据，能单独提取出来尽量单独提出来，不要把所有的常量都当做字面量放置在有需求的地方，用一个变量缓存的话，修改起来也十分方便。对象里的方法，能分离的分离，尽量不要一个嵌套着一个，搞不好就是一个泄露内存的闭包，分离出来，作为对象的直接方法，既可以方便多次利用，又不至于搞的太复杂。</p><br><p>好吧，要学的东西真的很多很多，但是只要把看到的不明白弄明白，然后准备好下一个不明白到来，这样就行了。</p>


          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://handishenniu.coding.me/blog/blog/2013/05/05/2013-05-05-cb-get-and-post/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lion">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="撼地神牛">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/blog/2013/05/05/2013-05-05-cb-get-and-post/" class="post-title-link" itemprop="https://handishenniu.coding.me/blog/page/25/index.html">浅谈HTTP中Get与Post的区别</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2013-05-05 08:40:00" itemprop="dateCreated datePublished" datetime="2013-05-05T08:40:00+08:00">2013-05-05</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-12-12 18:10:11" itemprop="dateModified" datetime="2018-12-12T18:10:11+08:00">2018-12-12</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/blog/categories/网络交互/" itemprop="url" rel="index"><span itemprop="name">网络交互</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/blog/categories/网络交互/剪贴板/" itemprop="url" rel="index"><span itemprop="name">剪贴板</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <div class="history-article">本文为归档内容,原始地址在 <a href="http://www.cnblogs.com/hustskyking/archive/2013/05/05/get-and-post.html" target="_blank">博客园</a>.</div>

<p>　Http定义了与服务器交互的不同方法，最基本的方法有4种，分别是GET，POST，PUT，DELETE。URL全称是资源描述符，我们可以这样认为：一个URL地址，它用于描述一个网络上的资源，而HTTP中的GET，POST，PUT，DELETE就对应着对这个资源的<span>查，改，增，删</span>4个操作。到这里，大家应该有个大概的了解了，GET一般用于<span>获取/查询</span>资源信息，而POST一般用于<span>更新</span>资源信息。</p><br><p>　　<span><strong>1</strong>.根据HTTP规范，GET用于信息获取，而且应该是安全的和幂等的。</span></p><br><p>　　(1).所谓安全的意味着该操作用于获取信息而非修改信息。换句话说，GET 请求一般不应产生副作用。就是说，它仅仅是获取资源信息，就像数据库查询一样，不会修改，增加数据，不会影响资源的状态。</p><br><p>　　<em>&nbsp;注意：这里安全的含义仅仅是指是非修改信息。</em></p><br><p>　　(2).幂等的意味着对同一URL的多个请求应该返回同样的结果。这里我再解释一下<span><strong>幂等</strong></span>这个概念：</p>

<p><code>幂等（idempotent、idempotence）是一个数学或计算机学概念，常见于抽象代数中。　　幂等有一下几种定义：　　对于单目运算，如果一个运算对于在范围内的所有的一个数多次进行该运算所得的结果和进行一次该运算所得的结果是一样的，那么我们就称该运算是幂等的。比如绝对值运算就是一个例子，在实数集中，有abs(a)=abs(abs(a))。　　对于双目运算，则要求当参与运算的两个值是等值的情况下，如果满足运算结果与参与运算的两个值相等，则称该运算幂等，如求两个数的最大值的函数，有在在实数集中幂等，即max(x,x)&amp;nbsp;=&amp;nbsp;x。</code></p>
<p>看完上述解释后，应该可以理解GET幂等的含义了。</p><br><p>　　但在实际应用中，以上2条规定并没有这么严格。引用别人文章的例子：比如，新闻站点的头版不断更新。虽然第二次请求会返回不同的一批新闻，该操作仍然被认为是安全的和幂等的，因为它总是返回当前的新闻。从根本上说，如果目标是当用户打开一个链接时，他可以确信从自身的角度来看没有改变资源即可。</p><br><p>　　<span><strong>2</strong>.根据HTTP规范，POST表示可能修改变服务器上的资源的请求。</span>继续引用上面的例子：还是新闻以网站为例，读者对新闻发表自己的评论应该通过POST实现，因为在评论提交后站点的资源已经不同了，或者说资源被修改了。</p>


<p>　　上面大概说了一下HTTP规范中GET和POST的一些原理性的问题。但在实际的做的时候，很多人却没有按照HTTP规范去做，导致这个问题的原因有很多，比如说：</p><br><p>　　<span><strong>1</strong></span>.很多人贪方便，更新资源时用了GET，因为用POST必须要到FORM（表单），这样会麻烦一点。</p><br><p>　　<span><strong>2</strong></span>.对资源的增，删，改，查操作，其实都可以通过GET/POST完成，不需要用到PUT和DELETE。</p><br><p>　　<span><strong>3</strong></span>.另外一个是，早期的Web MVC框架设计者们并<span>没有有意识地将URL当作抽象的资源来看待和设计</span>，所以导致一个比较严重的问题是传统的Web MVC框架基本上都只支持GET和POST两种HTTP方法，而不支持PUT和DELETE方法。</p><br><p>&nbsp;　　<em>简单解释一下MVC：MVC本来是存在于Desktop程序中的，M是指数据模型，V是指用户界面，C则是控制器。使用MVC的目的是将M和V的实现代码分离，从而使同一个程序可以使用不同的表现形式。</em></p><br><p>　　以上3点典型地描述了老一套的风格（没有严格遵守HTTP规范），随着架构的发展，现在出现REST(Representational State Transfer)，一套支持HTTP规范的新风格，这里不多说了，可以参考《RESTful Web Services》。</p>


<p>　　说完原理性的问题，我们再从<span>表面现像上面看看GET和POST的区别</span>：</p><br><p>　　<span><strong>1</strong></span>.GET请求的数据会附在URL之后（就是把数据放置在HTTP协议头中），以?分割URL和传输数据，参数之间以&lt;相连，如：login.action?name=hyddd&lt;password=idontknow&lt;verify=%E4%BD%A0%E5%A5%BD。如果数据是英文字母/数字，原样发送，如果是空格，转换为+，如果是中文/其他字符，则直接把字符串用BASE64加密，得出如：%E4%BD%A0%E5%A5%BD，其中％XX中的XX为该符号以16进制表示的ASCII。</p><br><p>　　POST把提交的数据则放置在是HTTP包的包体中。</p><br><p>　　<span><strong>2</strong></span>.”GET方式提交的数据最多只能是1024字节，理论上POST没有限制，可传较大量的数据，IIS4中最大为80KB，IIS5中为100KB”？？！</p><br><p>　　以上这句是我从其他文章转过来的，其实这样说是错误的，不准确的：</p><br><p>　　(1).首先是”GET方式提交的数据最多只能是1024字节”，因为GET是通过URL提交数据，那么GET可提交的数据量就跟URL的长度有直接关系了。而实际上，<span>URL不存在参数上限的问题，HTTP协议规范没有对URL长度进行限制</span>。这个限制是特定的浏览器及服务器对它的限制。IE对URL长度的限制是2083字节(2K+35)。对于其他浏览器，如Netscape、FireFox等，理论上没有长度限制，其限制取决于操作系统的支持。</p><br><p>　　注意这是限制是整个URL长度，而不仅仅是你的参数值数据长度。[见参考资料5]</p><br><p>　　(2).理论上讲，<span>POST是没有大小限制的，HTTP协议规范也没有进行大小限制</span>，说\POST数据量存在80K/100K的大小限制”是不准确的，POST数据是没有限制的，起限制作用的是服务器的处理程序的处理能力。</p><br><p>　　对于ASP程序，Request对象处理每个表单域时存在100K的数据长度限制。但如果使用Request.BinaryRead则没有这个限制。</p><br><p>　　由这个延伸出去，对于IIS 6.0，微软出于安全考虑，加大了限制。我们还需要注意：</p><br><p>　　　　 1).IIS 6.0默认ASP POST数据量最大为200KB，每个表单域限制是100KB。　　　　 2).IIS 6.0默认上传文件的最大大小是4MB。　　　　 3).IIS 6.0默认最大请求头是16KB。　　IIS 6.0之前没有这些限制。[见参考资料5]</p><br><p>　　所以上面的80K，100K可能只是默认值而已(注：关于IIS4和IIS5的参数，我还没有确认)，但肯定是可以自己设置的。由于每个版本的IIS对这些参数的默认值都不一样，具体请参考相关的IIS配置文档。</p><br><p>　　<span><strong>3</strong></span>.在ASP中，服务端获取GET请求参数用Request.QueryString，获取POST请求参数用Request.Form。在JSP中，用request.getParameter(\”XXXX\”)来获取，虽然jsp中也有request.getQueryString()方法，但使用起来比较麻烦，比如：传一个test.jsp?name=hyddd&lt;password=hyddd，用request.getQueryString()得到的是：name=hyddd&lt;password=hyddd。在PHP中，可以用$_GET和$_POST分别获取GET和POST中的数据，而$_REQUEST则可以获取GET和POST两种请求中的数据。值得注意的是，JSP中使用request和PHP中使用$_REQUEST都会有隐患，这个下次再写个文章总结。</p><br><p>　　<span><strong>4</strong></span>.POST的安全性要比GET的安全性高。注意：这里所说的安全性和上面GET提到的\安全”不是同个概念。上面\安全”的含义仅仅是不作数据修改，而这里安全的含义是真正的Security的含义，比如：通过GET提交数据，用户名和密码将明文出现在URL上，因为(1)登录页面有可能被浏览器缓存，(2)其他人查看浏览器的历史纪录，那么别人就可以拿到你的账号和密码了，除此之外，使用GET提交数据还可能会造成Cross-site request forgery攻击。</p><br><p>　　总结一下，<span>Get</span>是向服务器发索取数据的一种<span>请求</span>，而<span>Post</span>是向服务器提交数据的一种<span>请求</span>，在FORM（表单）中，Method默认为”GET”，实质上，GET和POST只是发送机制不同，并不是一个取一个发！</p>


<p><strong>参考资料</strong>：</p><br><p>[1].<a href="http://hi.baidu.com/liuzd003/blog/item/7bfecbfa6ea94ed8b58f318c.html" target="_blank" rel="noopener">http://hi.baidu.com/liuzd003/blog/item/7bfecbfa6ea94ed8b58f318c.html</a></p><br><p>[2].<a href="http://www.blogjava.net/onlykeke/archive/2006/08/23/65285.aspx" target="_blank" rel="noopener">http://www.blogjava.net/onlykeke/archive/2006/08/23/65285.aspx</a></p><br><p>[3].<a href="http://baike.baidu.com/view/2067025.htm" target="_blank" rel="noopener">http://baike.baidu.com/view/2067025.htm</a></p><br><p>[4].<a href="http://www.chxwei.com/article.asp?id=373" target="_blank" rel="noopener">http://www.chxwei.com/article.asp?id=373</a></p><br><p>[5].<a href="http://blog.csdn.net/somat/archive/2004/10/29/158707.aspx" target="_blank" rel="noopener">http://blog.csdn.net/somat/archive/2004/10/29/158707.aspx</a></p>


<p>本文转自：<a href="http://www.cnblogs.com/hyddd/archive/2009/03/31/1426026.html" target="_blank">hyddd</a></p>
          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://handishenniu.coding.me/blog/blog/2013/05/04/2013-05-04-cb-getkeywords/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lion">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="撼地神牛">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/blog/2013/05/04/2013-05-04-cb-getkeywords/" class="post-title-link" itemprop="https://handishenniu.coding.me/blog/page/25/index.html">Javascript综合应用小案例</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2013-05-04 02:38:00" itemprop="dateCreated datePublished" datetime="2013-05-04T02:38:00+08:00">2013-05-04</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-12-12 18:10:11" itemprop="dateModified" datetime="2018-12-12T18:10:11+08:00">2018-12-12</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/blog/categories/JavaScript/" itemprop="url" rel="index"><span itemprop="name">JavaScript</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/blog/categories/JavaScript/杂物间/" itemprop="url" rel="index"><span itemprop="name">杂物间</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <div class="history-article">本文为归档内容,原始地址在 <a href="http://www.cnblogs.com/hustskyking/archive/2013/05/04/getkeywords.html" target="_blank">博客园</a>.</div>

<p>按需求弄了一个 <strong>取词</strong> 以及 <strong>标红</strong> 的小应用。</p><br><p><a href="http://qianduannotes.sinaapp.com/getKeyword/" target="_blank"><img src="//img.alicdn.com/tfs/TB1oyqGa_tYBeNjy1XdXXXXyVXa-300-300.png" data-original="/blogimgs/2013/05/04/o_%e8%a7%86%e5%9b%be.png" data-source="http://images.cnblogs.com/cnblogs_com/hustskyking/477032/o_%e8%a7%86%e5%9b%be.png" alt="" width="716" height="388"></a></p><br><p>先上demo ：<a title="取词&&标红 demo" href="http://qianduannotes.sinaapp.com/getKeyword/" target="_blank">http://qianduannotes.sinaapp.com/getKeyword/</a></p><br><p>很多平时常用的东西，都用上了，所以拿出来说说。</p>


<p><strong>一、代码</strong></p><br><div class="cnblogs_Highlighter"><br><pre class="brush:javascript;collapse:true;;gutter:false;">var GetKeywords = {<br>  str: “”,<br>  limit: 11,<br>  keywords:[],<br><br>  init : function(){<br>    var box = this._(“article”),<br>      _this = this;<br><br>    //获取已经存在的关键词<br>    this.getAllKeyWord();<br><br>    //让rmKeyWord函数全局化<br>    window.rmkeyWord = this.rmkeyWord;<br><br>    //取词事件<br>    box.onmouseup = function(evt){<br>      var evt = evt || window.event,<br>        target = evt.target || evt.srcElement;<br><br>      //如果鼠标是在button上弹起，则忽略<br>      if(target.id == “btn”) return;<br>      GetKeywords.str = _this.getSelectionText();<br><br>      if(_this.str.length == 0) return;<br>      if(<em>this.</em>(“btn”)) {<br>        _this.removeBtn();<br>        if(GetKeywords.str == “”) return;<br>        _this.createBtn(evt);<br>        return;<br>      }<br>      _this.createBtn(evt);<br>    }<br>  },<br><br>  //工具函数<br>  _: function(obj){<br>    return document.getElementById(obj);<br>  },<br><br>  //获取选中文本<br>  getSelectionText: function(){<br>    if(window.getSelection) {<br>      return window.getSelection().toString();<br>    } else if(document.selection &amp;&amp; document.selection.createRange) {<br>      return document.selection.createRange().text;<br>    }<br>    return ‘’;<br>  },<br><br>  //创建按钮<br>  createBtn: function(evt){<br>    var button = document.createElement(“div”),<br>      evt = evt || window.event,<br>      x = evt.pageX || evt.x,<br>      y = evt.pageY || evt.y,<br>      i, j, len,<br>      cssList = “”,<br>      <em>this = this,<br>      csses = {<br>        “height” : “30px”,<br>        “line-height” : “30px”,<br>        “position”: “absolute”,<br>        “top”: y + 10 + “px”,<br>        “left”: x + 10 + “px”,<br>        “cursor”: “pointer”,<br>        “border”: “1px solid #000”,<br>        “background”: “#EEE”,<br>        “padding”: “2px 8px”,<br>        “border-radius”: “3px”<br>      };<br>    for(i in csses){<br>      if(csses.hasOwnProperty(i)){<br>        cssList += i + “:” + csses[i] + “;”;<br>      }<br>    }<br>    button.style.cssText = cssList;<br>    button.innerHTML = “添加到关键词列表”;<br>    button.setAttribute(“id”, “btn”);<br><br>    this.</em>(“article”).appendChild(button);<br><br>    button.onclick = function(){<br>      if(_this.str.length &gt; _this.limit){<br>        alert(“关键词长度最长为11，可以通过设置GetKeywords.limit来控制长度。”);<br>        _this.removeBtn();<br>        return;<br>      }<br><br>      for(j = 0, len = GetKeywords.keywords.length; j &lt; len; j++){<br>        if(GetKeywords.keywords[j] == _this.str){<br>          alert(“已经存在该关键词了~”);<br>          _this.removeBtn();<br>          return;<br>        }<br>        continue;<br>      }<br>      _this.keywords.push(_this.str);<br>      _this.setRed(_this.str);<br>      _this.addTo();<br>      <em>this.removeBtn();<br>    };<br>  },<br><br>  //删除按钮<br>  removeBtn: function(){<br>    var btn = this.</em>(“btn”);<br>    btn.parentNode.removeChild(btn);<br>  },<br><br>  //加入到关键词里列表<br>  addTo: function(){<br>    var word = this.<em>(“wordList”);<br>    word.innerHTML += “&lt;span&gt;&lt;font&gt;” + this.str + “&lt;/font&gt;&lt;a href=’#’ onclick=’rmkeyWord(this);’&gt;&lt;/a&gt;&lt;/span&gt;”;<br>  },<br><br>  //关键词标红<br>  setRed: function(str){<br>    var content = this.</em>(“article”),<br>      temp = ‘(‘ + str + ‘)’;<br>      reg = new RegExp(temp,’g’);<br><br>    content.innerHTML = content.innerHTML.replace(reg, “&lt;span style=’color:red;’&gt;$1&lt;/span&gt;”);<br>  },<br><br>  //删除标红<br>  rmRed: function(str){<br>    var content = this.<em>(“article”),<br>      temp = “(&lt;span[^&lt;]*” + str + “&lt;/span&gt;)”;<br>      reg = new RegExp(temp,’gi’);<br>    content.innerHTML = content.innerHTML.replace(reg, str);<br>  },<br><br>  //获取已经存在的关键词（也可以用来获取所有关键词）<br>  getAllKeyWord: function (){<br>    var spans = this.</em>(“wordList”).getElementsByTagName(“span”),<br>      key = [], i = 0, len;<br>    for(len = spans.length; i &lt; len; i++){<br>      var font = spans[i].getElementsByTagName(“font”)[0];<br>      var temp = font.innerText || font.textContent;<br>      this.setRed(temp);<br>      key.push(temp);<br>    }<br>    this.keywords = key;<br>  },<br><br>  //删除关键词<br>  rmkeyWord: function (obj){<br>    var target = obj.parentNode,<br>      word = obj.previousSibling.innerHTML,<br>      i = 0, len;<br>    GetKeywords.rmRed(word);<br>    for(len = GetKeywords.keywords.length; i &lt; len; i++){<br>      if(GetKeywords.keywords[i] == word){<br>        GetKeywords.keywords.splice(i,i);<br>      }<br>      continue;<br>    }<br>    target.parentNode.removeChild(target);<br>    return;<br>  }<br>}<br><br>GetKeywords.init();</pre><br></div><br><br><br><p><span>以上是所有js代码，比较长，下面将列举一些比较突出的点（望高人多多指点）。</span></p>


<p><strong>二、代码分析</strong></p><br><p><strong>1.获取文本</strong></p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">getSelectionText: function()&#123;</span><br><span class="line">    if(window.getSelection) &#123;</span><br><span class="line">        return window.getSelection().toString();</span><br><span class="line">    &#125; else if(document.selection &amp;&amp; document.selection.createRange) &#123;</span><br><span class="line">        return document.selection.createRange().text;</span><br><span class="line">    &#125;</span><br><span class="line">    return &apos;&apos;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个在以前（<a class="titlelink" href="http://www.cnblogs.com/hustskyking/archive/2013/04/11/set_and_get_cursor_position.html" target="_blank">JavaScript操控光标，你会么？</a>）的文章里也说过，就不赘述了。</p>


<p><strong>2.创建控制框</strong></p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">createBtn: function(evt)&#123;</span><br><span class="line">    var button = document.createElement(&quot;div&quot;),</span><br><span class="line">        //...</span><br><span class="line">        csses = &#123;</span><br><span class="line">            &quot;height&quot; : &quot;30px&quot;,</span><br><span class="line">            &quot;line-height&quot; : &quot;30px&quot;,</span><br><span class="line">            &quot;position&quot;: &quot;absolute&quot;,</span><br><span class="line">            &quot;top&quot;: y + 10 + &quot;px&quot;,</span><br><span class="line">            &quot;left&quot;: x + 10 + &quot;px&quot;,</span><br><span class="line">            &quot;cursor&quot;: &quot;pointer&quot;,</span><br><span class="line">            &quot;border&quot;: &quot;1px solid #000&quot;,</span><br><span class="line">            &quot;background&quot;: &quot;#EEE&quot;,</span><br><span class="line">            &quot;padding&quot;: &quot;2px 8px&quot;,</span><br><span class="line">            &quot;border-radius&quot;: &quot;3px&quot;</span><br><span class="line">        &#125;;</span><br><span class="line">    for(i in csses)&#123;</span><br><span class="line">        if(csses.hasOwnProperty(i))&#123;</span><br><span class="line">            cssList += i + &quot;:&quot; + csses[i] + &quot;;&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    button.style.cssText = cssList;</span><br><span class="line">    button.innerHTML = &quot;添加到关键词列表&quot;;</span><br><span class="line">    button.setAttribute(&quot;id&quot;, &quot;btn&quot;);</span><br><span class="line">　　//...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里有一点我想说说，在写js的时候，会经常涉及到对DOM对象style的处理，如果不想额外加入一个plugins.css之类的文件，可以像上面一样，将样式放置在一个对象中，然后利用for in将其写入，本来开始我用的是</p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">obj.style[i] = csses[i];</span><br></pre></td></tr></table></figure>
<p>不知道为什么，在IE下报错了，后来便用cssText代替。</p><br><p>效果：</p><br><p><a href="http://qianduannotes.sinaapp.com/getKeyword/" target="_blank"><img src="//img.alicdn.com/tfs/TB1oyqGa_tYBeNjy1XdXXXXyVXa-300-300.png" data-original="/blogimgs/2013/05/04/o_%e6%b7%bb%e5%8a%a0%e5%88%b0%e5%88%97%e8%a1%a8.png" data-source="http://images.cnblogs.com/cnblogs_com/hustskyking/477032/o_%e6%b7%bb%e5%8a%a0%e5%88%b0%e5%88%97%e8%a1%a8.png" alt="添加到列表" width="610" height="312"></a></p>


<p><strong>3.标红</strong></p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//关键词标红</span><br><span class="line">setRed: function(str)&#123;</span><br><span class="line">    var content = this._(&quot;article&quot;),</span><br><span class="line">        temp = &apos;(&apos; + str + &apos;)&apos;;</span><br><span class="line">        reg = new RegExp(temp,&apos;g&apos;);</span><br><span class="line"></span><br><span class="line">    content.innerHTML = content.innerHTML.replace(reg, &quot;&lt;span&gt;$1&lt;/span&gt;&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里主要就是正则表达式的事情了，正则的话，推荐两篇文章</p><br><ul><br><li>一篇是司徒正美的，讲的比较全面，比较系统。<a href="http://www.cnblogs.com/rubylouvre/archive/2009/11/02/1594731.html" target="_blank">点我链接过去→</a></li><br><li>一篇是30分钟搞定正则，这个讲说是对所有语言，JS的话正则这一块还不是特别完善和强大。<a href="http://manual.phpv.net/regular_expression.html" target="_blank">点我链接过去→</a></li><br></ul><br><p>哈哈，相信用过正则的人不需要我来解释这个<span>$1</span>了吧，他的意思就是匹配到的第一个。</p><br><p>当然，删除标红和这个原理是差不多的。</p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//删除标红</span><br><span class="line">rmRed: function(str)&#123;</span><br><span class="line">    var content = this._(&quot;article&quot;),</span><br><span class="line">        temp = &quot;(&lt;span[^&lt;]*&quot; +=&quot;&quot; str=&quot;&quot; &quot;&lt;=&quot;&quot; span=&quot;&quot;&gt;)&quot;;</span><br><span class="line">        reg = new RegExp(temp,&apos;gi&apos;);</span><br><span class="line"></span><br><span class="line">    content.innerHTML = content.innerHTML.replace(reg, str);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&lt;/span[^&lt;]*”&gt;</p>
<p>这里是写完这篇blog才发现的一个bug， IE下如果rmRed中的正则是’g’,貌似该函数会无效，在IE8控制台下查看，NND，输出innerHTML中的标签全部变成大写了，无奈，只好改成’gi’。</p>


<p><strong>4.获取所有关键词和删除关键词</strong></p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">//获取已经存在的关键词（也可以用来获取所有关键词）</span><br><span class="line">getAllKeyWord: function ()&#123;</span><br><span class="line">    //...</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line">//删除关键词</span><br><span class="line">rmkeyWord: function (obj)&#123;</span><br><span class="line">    //...</span><br><span class="line">    GetKeywords.rmRed(word);</span><br><span class="line">    for(len = GetKeywords.keywords.length; i &lt; len; i++)&#123;</span><br><span class="line">        if(GetKeywords.keywords[i] == word)&#123;</span><br><span class="line">            GetKeywords.keywords.splice(i,i);</span><br><span class="line">        &#125;</span><br><span class="line">        continue;</span><br><span class="line">    &#125;</span><br><span class="line">    //...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个地方，有一个疑问，在调用的时候，使用this.keywords没反应，但是改成GetKeywords就行了，还没研究具体原因是什么~</p>


<p><strong>5.初始化</strong></p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GetKeywords.init();</span><br></pre></td></tr></table></figure>
<p>init()为总入口，进去之后，先获取已经存在的关键词，然后标红，接着绑定onmouseup事件。</p>


<p><strong>三、然后</strong></p><br><p>当然咯，这个案例的ajax部分还没写，弄完之后还得给后台送过去。。好吧，明天接着弄吧。</p><br><p>写这玩意儿还是花了点功夫，不过鄙人写代码的水平还在初级阶段，望大神们不要吐槽，多提宝贵意见，谢谢！</p><br><p>然后，还是那个demo，<a title="取词&&标红 demo" href="http://qianduannotes.sinaapp.com/getKeyword/" target="_blank">http://qianduannotes.sinaapp.com/getKeyword/</a></p><br><p>顺便，推广下，团队做的一个网站，主要技术是爬虫，高峰期PV稳定在120W以上，找工作的童鞋可以多去踩踩~</p><br><p><strong><a title="海投网" href="http://xjh.haitou.cc/" target="_blank">宣讲会查询系统&mdash;&mdash;海投网</a>&nbsp;</strong></p>


<p>P.S：刚让队友测试，还是发现了不少bug，果然考虑问题还是不全面啊~还要继续加油。。。</p>


          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://handishenniu.coding.me/blog/blog/2013/04/27/2013-04-27-cb-mianshi/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lion">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="撼地神牛">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/blog/2013/04/27/2013-04-27-cb-mianshi/" class="post-title-link" itemprop="https://handishenniu.coding.me/blog/page/25/index.html">腾讯的三轮面试（web前端）</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2013-04-27 11:59:00" itemprop="dateCreated datePublished" datetime="2013-04-27T11:59:00+08:00">2013-04-27</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-12-12 18:10:11" itemprop="dateModified" datetime="2018-12-12T18:10:11+08:00">2018-12-12</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/blog/categories/观点和感想/" itemprop="url" rel="index"><span itemprop="name">观点和感想</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <div class="history-article">本文为归档内容,原始地址在 <a href="http://www.cnblogs.com/hustskyking/archive/2013/04/27/mianshi.html" target="_blank">博客园</a>.</div>

<p><strong></strong>笔试就不说了，说多了都是泪，选择题基本不会，幸好填空题和附加题都拿下了，貌似最后78分。</p>


<p><strong>【一面】~=110分钟 &nbsp;2013/04/24 11:20 &nbsp;星期三</strong></p><br><p>进门静坐30分钟做题。</p><br><p>填空题+大题+问答题</p><br><p>&gt;&gt;填空题何时接触电脑  何时接触前端运算符   字符串处理 延时  display position  XMLHttpRequest  正则Jquery绑定事件  cookie</p><br><p>&gt;&gt;大题BOM浏览器信息浏览器兼容性举例闭包作用与举例新闻ul列表，插入3个，获取index全文单词首字母大写ajax过程</p><br><p>&gt;&gt;逻辑题任何时间分针和时针夹角文章单词（字母）频率出现最高30分钟等到车概率是70%，那10分钟呢？一个班学舞蹈的有75%，学唱歌的有85%，问同时学习舞蹈和唱歌的最多多少，最少多少？两个很大数的加法运算</p><br><p>&gt;&gt;我的提问为什么不问我框架你觉得我哪些方面还有欠缺，觉得我如何如果有望进入二面，什么时候可以得到通知</p><br><p>&gt;&gt;完了之后一起下楼时我说其他几家公司的问题和腾讯的有比较大的区别，区别是XXXXXX然后他问我家在哪里然后说深圳还是比较适合我我说但愿还能见到你他笑了笑</p><br><p><strong>【二面】~=40分钟&nbsp;<strong>2013/04/25 14:00 &nbsp;星期四</strong></strong>面试时间是两点钟，两点过几分进入了面试官所在的包间。进去之前楼下签到的hr要我把一摞草稿纸带到621房间的面试官，进门给他之后，他说那把大椅子是坏的，<br>要我往后坐一点（防止向前倾倒）。</p><br><p>开始的时候他没怎么说话，埋头看着我的简历，于是我主动开始扯了几句关于自己的介绍。也不知他听到没<br>有，等我说完，马上又说：好吧，你先自我介绍下。（一脸黑线…）</p><br><p>期间问了我为什么不打算考研，为什么选择前端，我做的最自豪的事情是什么。</p><br><p>叽哩吧啦一阵子后，他要我说说我的人生规划和职业规划（颇为蛋疼，这些问题不是应该HR面才会问的么<br>），我顺着他的来，也比较xx的说了一番。</p><br><p>反向代理输入网址到出现页面的过程（IP解析，DNS解析等）页面流量堆栈</p><br><p>接着，问了我-1在计算机中怎么表示，如何判断数组A是否为数组B的子集。然后是一个概率问题，假设长江以北有80W人，长江以南有20W人，A向B打电话算一个电话，如果打了<br>10W个电话，那么长江以北打向长江以南的电话有多少个？</p><br><p>没问太多问题，都是些基础的，最后他问我有什么问题。</p><br><p>&gt;&gt;我问了问为什么不问我前端的问题如果通过二面，什么时候可以给我回复对我有什么学习上的建议</p><br><p>面试官留言：\一把刀有刀锋和刀背，刀锋要磨锐利，但是刀背的锻炼也要加强。”</p>


<p><strong>【HR面】~=30分钟 2013/04/27 20:00 星期六</strong>进去先看上几位面试官对我的评价，安静时刻我跟她扯淡了几句，缓和了下尴尬的气氛。然后她瞄了瞄我的简历，接着就问我考不考研，很明显我的答案是不。然后她又问为什么~接着让我说说自己最满意的一件事和最不满意的一件事，自己最大的缺点和最大的优点扯了半天之后（此处略去20分钟扯淡），又开始看我的简历，问了我项目中遇到哪些困难，我说了一个还未<br>解决的bug，她反问为什么不解决，然后叽哩吧啦了一阵子。</p><br><p>最后问我有没有什么问题。按惯例，问了问最早什么时候给通知，然后问了问期间如果有不明白问题可以通过<br>什么方式联系她之类的。</p><br><p>整个过程还算顺利。</p>


<p><strong>HR告诉我五一之后可以查询录取状态，求人品吧~</strong></p>


<p><strong>顺便把在搜狐和网易的面试笔试经历也说说吧~</strong></p><br><p><strong>&gt;&gt;搜狐</strong></p><br><p>搜狐的太久了，记不太清楚了</p><br><p>那次只为攒经验，是俺平生第一次参加公司面试。不过收获还是有的~</p><br><p>时间太久了，也记不清了，没有提交笔试题，但是还是要我去面试了。问他有几轮面试，告诉我因时间匆忙，只给一轮技术面，如果满意直接HR。</p><br><p>大概问题记不太清。虽然感觉答的还不错，但是最后还是被刷了。</p><br><p>【技术面】~=60分钟-问了下我在团队学了些什么。 -然后就是很多\你是怎么理解XX”。。-XX中有 闭包，原型链， 框架结构等</p>


<p>&gt;&gt;<strong>网易</strong></p><br><p>今天4.27，好像是3.26参加的面试，时间太久，也记得不是很清楚了。</p><br><p>我没有把任何面试官当做正经的面试官，男的就是我的学长，女的就是我的学姐，仅此而已，所以每次交流都是平和的心态。</p><br><p>学长们（每次面我的都是个男的）时不时露出笑意，现场气氛没有那么紧张。</p><br><p>【一面】 ~=30分钟闭包IE6趋势框架</p><br><p>【二面】 ~=90分钟框架比较 jQuery prototype YUI框架特点css兼容性   IE6 bugseaJS AMD CMD kissyJS原型链 闭包JS基础细节</p><br><p>不让谈百度框架</p><br><p>【HR面】~=25分钟自我介绍身边人的评价最不满意的一件事情规划为什么不想考研有什么困难</p><br><p>薪资待遇何时通知</p>
          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://handishenniu.coding.me/blog/blog/2013/04/27/2013-04-27-cb-garbage-collection/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lion">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="撼地神牛">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/blog/2013/04/27/2013-04-27-cb-garbage-collection/" class="post-title-link" itemprop="https://handishenniu.coding.me/blog/page/25/index.html">JavaScript垃圾回收机制</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2013-04-27 03:14:00" itemprop="dateCreated datePublished" datetime="2013-04-27T03:14:00+08:00">2013-04-27</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-12-12 18:10:11" itemprop="dateModified" datetime="2018-12-12T18:10:11+08:00">2018-12-12</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/blog/categories/JavaScript/" itemprop="url" rel="index"><span itemprop="name">JavaScript</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <div class="history-article">本文为归档内容,原始地址在 <a href="http://www.cnblogs.com/hustskyking/archive/2013/04/27/garbage-collection.html" target="_blank">博客园</a>.</div>

<p><strong>一、垃圾回收的必要性</strong></p><br><p>　　下面这段话引自《JavaScript权威指南（第四版）》</p><br><p><em>　　由于字符串、对象和数组没有固定大小，所有当他们的大小已知时，才能对他们进行动态的存储分配。JavaScript程序每次创建字符串、数组或对象时，解释器都必须分配内存来存储那个实体。只要像这样动态地分配了内存，最终都要释放这些内存以便他们能够被再用，否则，JavaScript的解释器将会消耗完系统中所有可用的内存，造成系统崩溃。</em></p><br><p>　　这段话解释了为什么需要系统需要垃圾回收，JS不像C/C++，他有自己的一套垃圾回收机制（Garbage Collection）。JavaScript的解释器可以检测到何时程序不再使用一个对象了，当他确定了一个对象是无用的时候，他就知道不再需要这个对象，可以把它所占用的内存释放掉了。例如：</p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var a = &quot;before&quot;;</span><br><span class="line">var b = &quot;override a&quot;;</span><br><span class="line">var a = b; //重写a</span><br></pre></td></tr></table></figure>
<p>　　这段代码运行之后，\before”这个字符串失去了引用（之前是被a引用），系统检测到这个事实之后，就会释放该字符串的存储空间以便这些空间可以被再利用。</p>


<p><strong>二、垃圾回收原理浅析</strong></p><br><p><span>　　现在各大浏览器通常用采用的垃圾回收有两种方法：标记清除、引用计数。</span></p><br><p><strong>1、标记清除</strong></p><br><p>　　这是javascript中最常用的垃圾回收方式。当变量进入执行环境是，就标记这个变量为\进入环境”。从逻辑上讲，永远不能释放进入环境的变量所占用的内存，因为只要执行流进入相应的环境，就可能会用到他们。当变量离开环境时，则将其标记为\离开环境”。　　垃圾收集器在运行的时候会给存储在内存中的所有变量都加上标记。然后，它会去掉环境中的变量以及被环境中的变量引用的标记。而在此之后再被加上标记的变量将被视为准备删除的变量，原因是环境中的变量已经无法访问到这些变量了。最后。垃圾收集器完成内存清除工作，销毁那些带标记的值，并回收他们所占用的内存空间。</p><br><p><em>关于这一块，建议读读<a title="作用域链" href="http://www.cnblogs.com/TomXu/archive/2012/01/18/2312463.html" target="_blank">Tom大叔的几篇文章</a>，关于作用域链的一些知识详解，读完差不多就知道了，哪些变量会被做标记。</em><strong>2、引用计数</strong></p><br><p>　　另一种不太常见的垃圾回收策略是引用计数。引用计数的含义是跟踪记录每个值被引用的次数。当声明了一个变量并将一个引用类型赋值给该变量时，则这个值的引用次数就是1。相反，如果包含对这个值引用的变量又取得了另外一个值，则这个值的引用次数就减1。当这个引用次数变成0时，则说明没有办法再访问这个值了，因而就可以将其所占的内存空间给收回来。这样，垃圾收集器下次再运行时，它就会释放那些引用次数为0的值所占的内存。&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;但是用这种方法存在着一个问题，下面来看看代码：</p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">function problem() &#123;</span><br><span class="line">    var objA = new Object();</span><br><span class="line">    var objB = new Object();</span><br><span class="line"></span><br><span class="line">    objA.someOtherObject = objB;</span><br><span class="line">    objB.anotherObject = objA;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>　　在这个例子中，objA和objB通过各自的属性相互引用；也就是说这两个对象的引用次数都是2。在采用引用计数的策略中，由于函数执行之后，这两个对象都离开了作用域，函数执行完成之后，objA和objB还将会继续存在，因为他们的引用次数永远不会是0。这样的相互引用如果说很大量的存在就会导致大量的内存泄露。&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;　　我们知道，IE中有一部分对象并不是原生JavaScript对象。例如，其BOM和DOM中的对象就是使用C++以COM（Component Object&nbsp;Model，组件对象）对象的形式实现的，而COM对象的垃圾回收器就是采用的引用计数的策略。因此，即使IE的Javascript引擎使用标记清除的策略来实现的，但JavaScript访问的COM对象依然是基于引用计数的策略的。说白了，只要IE中涉及COM对象，就会存在循环引用的问题。看看下面的这个简单的例子：</p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var element = document.getElementById(&quot;some_element&quot;);</span><br><span class="line">var myObj =new Object();</span><br><span class="line">myObj.element = element;</span><br><span class="line">element.someObject = myObj;</span><br></pre></td></tr></table></figure>
<p>　　上面这个例子中，在一个DOM元素(element)与一个原生JavaScript对象(myObj)之间建立了循环引用。其中，变量myObj有一个名为element的属性指向element；而变量element有一个名为someObject的属性回指到myObj。由于循环引用，即使将例子中的DOM从页面中移除，内存也永远不会回收。&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;　　不过上面的问题也不是不能解决，我们可以手动切断他们的循环引用。</p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">myObj.element = null;</span><br><span class="line">element.someObject =null;</span><br></pre></td></tr></table></figure>
<p>　　这样写代码的话就可以解决循环引用的问题了，也就防止了内存泄露的问题。</p>


<p><strong>三、减少JavaScript中的垃圾回收</strong></p><br><p>　　首先，最明显的，new关键字就意味着一次内存分配，例如 new Foo()。最好的处理方法是：在初始化的时候新建对象，然后在后续过程中尽量多的重用这些创建好的对象。</p><br><p>另外还有以下三种内存分配表达式（可能不像new关键字那么明显了）：</p><br><ul><br><li>{} （创建一个新对象）</li><br><li>[] （创建一个新数组）</li><br><li>function() {…} (创建一个新的方法，注意：新建方法也会导致垃圾收集！！)</li><br></ul><br><p><strong>1、对象object优化</strong></p><br><p>　　为了最大限度的实现对象的重用，应该像避使用new语句一样避免使用{}来新建对象。</p><br><p>　　{\foo”:”bar”}这种方式新建的带属性的对象，常常作为方法的返回值来使用，可是这将会导致过多的内存创建，因此最好的解决办法是：每一次函数调用完成之后，将需要返回的数据放入一个全局的对象中，并返回此全局对象。如果使用这种方式，就意味着每一次方法调用都会导致全局对象内容的修改，这有可能会导致错误的发生。因此，一定要对此全局对象的使用进行详细的注释和说明。</p><br><p>　　有一种方式能够保证对象（确保对象prototype上没有属性）的重复利用，那就是遍历此对象的所有属性，并逐个删除，最终将对象清理为一个空对象。</p><br><p>　　cr.wipe(obj)方法就是为此功能而生，代码如下：<em><em>&nbsp;</em></em></p><br><div><br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// 删除obj对象的所有属性，高效的将obj转化为一个崭新的对象！</span><br><span class="line">cr.wipe = function (obj) &#123;</span><br><span class="line">    for (var p in obj) &#123;</span><br><span class="line">         if (obj.hasOwnProperty(p))</span><br><span class="line">            delete obj[p];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><br><br></div><br><p>　　有些时候，你可以使用cr.wipe(obj)方法清理对象，再为obj添加新的属性，就可以达到重复利用对象的目的。虽然通过清空一个对象来获取\新对象”的做法，比简单的通过{}来创建对象要耗时一些，但是在实时性要求很高的代码中，这一点短暂的时间消耗，将会有效的减少垃圾堆积，并且最终避免垃圾回收暂停，这是非常值得的！</p><br><p><strong>2、数组array优化</strong></p><br><p>　　将[]赋值给一个数组对象，是清空数组的捷径（例如： arr = [];），但是需要注意的是，这种方式又创建了一个新的空对象，并且将原来的数组对象变成了一小片内存垃圾！实际上，将数组长度赋值为0（arr.length = 0）也能达到清空数组的目的，并且同时能实现数组重用，减少内存垃圾的产生。</p>


<p><strong>3、方法function优化</strong></p><br><p>　　方法一般都是在初始化的时候创建，并且此后很少在运行时进行动态内存分配，这就使得导致内存垃圾产生的方法，找起来就不是那么容易了。但是从另一角度来说，这更便于我们寻找了，因为只要是动态创建方法的地方，就有可能产生内存垃圾。例如：将方法作为返回值，就是一个动态创建方法的实例。</p><br><p>　　在游戏的主循环中，setTimeout或requestAnimationFrame来调用一个成员方法是很常见的，例如：</p><br><div><br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">setTimeout(</span><br><span class="line">    (function(self) &#123;</span><br><span class="line">      return function () &#123;</span><br><span class="line">              self.tick();</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;)(this), 16)</span><br></pre></td></tr></table></figure><br><br></div><br><p>　　每过16毫秒调用一次this.tick()，嗯，乍一看似乎没什么问题，但是仔细一琢磨，每一次调用都返回了一个新的方法对象，这就导致了大量的方法对象垃圾！</p><br><p>　　为了解决这个问题，可以将作为返回值的方法保存起来，例如：</p><br><div><br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// at startup</span><br><span class="line">this.tickFunc = (</span><br><span class="line">    function(self) &#123;</span><br><span class="line">      return function() &#123;</span><br><span class="line">                self.tick();</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">)(this);</span><br><span class="line"></span><br><span class="line">// in the tick() function</span><br><span class="line">setTimeout(this.tickFunc, 16);</span><br></pre></td></tr></table></figure><br><br></div><br><p>　　相比于每次都新建一个方法对象，这种方式在每一帧当中重用了相同的方法对象。这种方式的优势是显而易见的，而这种思想也可以应用在任何以方法为返回值或者在运行时创建方法的情况当中。</p>


<p><strong>4、高级技术</strong></p><br><p>　　从根本上来说，javascript本身就是围绕着垃圾收集来设计的。随着我们工作的进行，避免内存垃圾变得越来越困难。因为很多方便实用的Javascript库方法也会产生一些新的对象。对于这些库方法产生的垃圾，我们束手无策，只能重新翻看文档，并且检查方法的返回值。例如，数组的slice方法返回一个新的数组（在不修改原数组的基础上，截取出一部分作为新数组），字符串的substr方法返回一个新的字符串（在不修改原字符串的基础上，截取出一部分字符串作为返回值）等等。</p><br><p>　　调用这些库方法，将会创建内存垃圾，而你能做的，只有避免调用这些方法，或者用不创建系统垃圾的方式重写这些方法（有点极端啦~）。</p><br><p>　　例如，在Construct 2引擎中，从数组中利用下标来删除一个元素，是经常进行的操作。最初我们是用下面这种方式来实现的：</p><br><div><br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var sliced = arr.slice(index + 1);</span><br><span class="line">arr.length = index;</span><br><span class="line">arr.push.apply(arr, sliced);</span><br></pre></td></tr></table></figure><br><br></div><br><p>　　然而，slice方法会返回一个新的数组对象（数组中的元素是原数组中删掉的部分），并且会通过arr.push.apply方法将元素重新复制回原数组，但是在此操作之后，该数组就成为了一片内存垃圾。由于这是我们引擎中的垃圾产生的热点代码（使用频率非常很高），因此我们利用了迭代的方式重写了上述代码：</p><br><div><br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">for (var i = index, len = arr.length – 1; i &lt; len; i++)</span><br><span class="line">    arr[i] = arr[i + 1];</span><br><span class="line">arr.length = len;</span><br></pre></td></tr></table></figure><br><br></div><br><p>　　显然，重写大量的库函数是非常痛苦的，因此你必须仔细权衡方法的易用性和内存垃圾产生情况。如果产生大量内存垃圾的方法在动画的每一帧中被多次调用，你可能就会兴高采烈的重写库函数啦。</p><br><p>　　在递归函数中，通过{}构造空对象，并在递归过程中传递数据，虽然是很方便的。但是更好的方式是：利用一个单独的数组对象作为堆栈，在递归过程中对数组进行push和pop操作。更进一步，不要调用array的pop方法（pop将会使得array的最后一个元素将会变成内存垃圾），而应该使用一个索引来记录数组的最后一个元素的位置，在pop时简单的将索引减一即可；类似的，将索引加1来代替array的push操作，只有当索引对应的元素不存在时，才执行真正的push为数组加入一个新元素。</p><br><p>　　另外，在任何时候，都应该避免使用向量对象（例如：包含x和y属性的vector2对象）。有些方法将向量对象作为方法返回值，既可以支持返回值的再次修改，又能够将需要的属性一次性返回，使用起来非常方便。但是有时候在一帧动画中，创建了成百上千个这样的向量对象，从而导致严重的垃圾回收性能问题，也是非常常见的。因此最好将这些方法分离成具有独立职责的功能个体，例如：利用getX()和getY()方法（返回具体数据）代替getPosition()方法（返回一个vector2对象）。</p>


<p><strong>四、总结</strong></p><br><p>　　在Javascript中，彻底避免垃圾回收是非常困难的。垃圾回收机制与实时软件（例如：游戏）的实时性要求，从根本上就是对立的。</p><br><p>　　但是，为了减少内存垃圾，我们还是可以对javascript代码进行彻底检查，有些代码中存在明显的产生过多内存垃圾的问题代码，这些正是我们需要检查并且完善的。</p><br><p>　　我认为，只要我们投入更多的精力和关注，实现实时的、低垃圾收集的javascript应用还是很有可能的。毕竟，对于可交互性要求较高的游戏或应用来说，实时性和低垃圾收集，两者都是至关重要。</p>


<p><strong>五、参考资料</strong></p><br><p><strong>　　</strong>1.&nbsp;<a href="http://fed.renren.com/archives/605#more-605" target="_blank">人人FED</a></p><br><p>　　2.&nbsp;<a href="http://www.cnblogs.com/jeffwongishandsome/archive/2009/05/17/1458405.html" target="_blank">Jeff Wong</a></p><br><p>　　3. 《JavaScript权威指南(第四版)》</p>
          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://handishenniu.coding.me/blog/blog/2013/04/24/2013-04-24-cb-javascript-closure-usages/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lion">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="撼地神牛">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/blog/2013/04/24/2013-04-24-cb-javascript-closure-usages/" class="post-title-link" itemprop="https://handishenniu.coding.me/blog/page/25/index.html">JS闭包的用途</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2013-04-24 08:41:00" itemprop="dateCreated datePublished" datetime="2013-04-24T08:41:00+08:00">2013-04-24</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-12-12 18:10:11" itemprop="dateModified" datetime="2018-12-12T18:10:11+08:00">2018-12-12</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/blog/categories/JavaScript/" itemprop="url" rel="index"><span itemprop="name">JavaScript</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/blog/categories/JavaScript/剪贴板/" itemprop="url" rel="index"><span itemprop="name">剪贴板</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <div class="history-article">本文为归档内容,原始地址在 <a href="http://www.cnblogs.com/hustskyking/archive/2013/04/24/javascript-closure-usages.html" target="_blank">博客园</a>.</div>

<p>我们来看看闭包的用途。事实上，通过使用闭包，我们可以做很多事情。比如模拟面向对象的代码风格；更优雅，更简洁的表达出代码；在某些方面提升代码的执行效率。</p><br><p><strong>1. 匿名自执行函数</strong></p><br><p>我们知道所有的变量，如果不加上var关键字，则默认的会添加到全局对象的属性上去，这样的临时变量加入全局对象有很多坏处，比如：别的函数可能误用这些变量；造成全局对象过于庞大，影响访问速度(因为变量的取值是需要从原型链上遍历的)。除了每次使用变量都是用var关键字外，我们在实际情况下经常遇到这样一种情况，即有的函数只需要执行一次，其内部变量无需维护，比如UI的初始化，那么我们可以使用闭包：</p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">var datamodel = &#123;</span><br><span class="line">    table : [],</span><br><span class="line">    tree : &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">(function(dm)&#123;</span><br><span class="line">    for(var i = 0; i &lt; dm.table.rows; i++)&#123;</span><br><span class="line">       var row = dm.table.rows[i];</span><br><span class="line">       for(var j = 0; j &lt; row.cells; i++)&#123;</span><br><span class="line">           drawCell(i, j);</span><br><span class="line">       &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //build dm.tree    </span><br><span class="line">&#125;)(datamodel);</span><br></pre></td></tr></table></figure>
<p>我们创建了一个匿名的函数，并立即执行它，由于外部无法引用它内部的变量，因此在执行完后很快就会被释放，关键是这种机制不会污染全局对象。<strong>2.缓存</strong></p><br><p>再来看一个例子，设想我们有一个处理过程很耗时的函数对象，每次调用都会花费很长时间，那么我们就需要将计算出来的值存储起来，当调用这个函数的时候，首先在缓存中查找，如果找不到，则进行计算，然后更新缓存并返回值，如果找到了，直接返回查找到的值即可。闭包正是可以做到这一点，因为它不会释放外部的引用，从而函数内部的值可以得以保留。</p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">var CachedSearchBox = (function()&#123;  </span><br><span class="line">    var cache = &#123;&#125;,  </span><br><span class="line">       count = [];  </span><br><span class="line">    return &#123;  </span><br><span class="line">       attachSearchBox : function(dsid)&#123;  </span><br><span class="line">           if(dsid in cache)&#123;//如果结果在缓存中  </span><br><span class="line">              return cache[dsid];//直接返回缓存中的对象  </span><br><span class="line">           &#125;  </span><br><span class="line">           var fsb = new uikit.webctrl.SearchBox(dsid);//新建  </span><br><span class="line">           cache[dsid] = fsb;//更新缓存  </span><br><span class="line">           if(count.length &gt; 100)&#123;//保正缓存的大小&lt;=100  </span><br><span class="line">              delete cache[count.shift()];  </span><br><span class="line">           &#125;  </span><br><span class="line">           return fsb;        </span><br><span class="line">       &#125;,  </span><br><span class="line">   </span><br><span class="line">       clearSearchBox : function(dsid)&#123;  </span><br><span class="line">           if(dsid in cache)&#123;  </span><br><span class="line">              cache[dsid].clearSelection();    </span><br><span class="line">           &#125;  </span><br><span class="line">       &#125;  </span><br><span class="line">    &#125;;  </span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>
<p>CachedSearchBox.attachSearchBox(“input1”);  </p>
<p>这样，当我们第二次调用CachedSearchBox.attachSerachBox(\input1”)的时候，我们就可以从缓存中取道该对象，而不用再去创建一个新的searchbox对象。<strong>3.实现封装</strong></p><br><p>可以先来看一个关于封装的例子，在person之外的地方无法访问其内部的变量，而通过提供闭包的形式来访问：</p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">var person = function()&#123;</span><br><span class="line">    //变量作用域为函数内部，外部无法访问  </span><br><span class="line">    var name = &quot;default&quot;;</span><br><span class="line"></span><br><span class="line">    return &#123;</span><br><span class="line">       getName : function()&#123;</span><br><span class="line">           return name;</span><br><span class="line">       &#125;,</span><br><span class="line">       setName : function(newName)&#123;</span><br><span class="line">           name = newName;</span><br><span class="line">       &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;();</span><br><span class="line"></span><br><span class="line">print(person.name);//直接访问，结果为undefined  </span><br><span class="line">print(person.getName());</span><br><span class="line">person.setName(&quot;abruzzi&quot;);</span><br><span class="line">print(person.getName());</span><br><span class="line"></span><br><span class="line">得到结果如下：</span><br><span class="line"></span><br><span class="line">undefined</span><br><span class="line">default</span><br><span class="line">abruzzi</span><br></pre></td></tr></table></figure>
<p><strong>4. 闭包的另一个重要用途是实现面向对象中的对象，传统的对象语言都提供类的模板机制</strong>这样不同的对象(类的实例)拥有独立的成员及状态，互不干涉。虽然JavaScript中没有类这样的机制，但是通过使用闭包，我们可以模拟出这样的机制。还是以上边的例子来讲：</p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">function Person()&#123;</span><br><span class="line">    var name = &quot;default&quot;;</span><br><span class="line"></span><br><span class="line">    return &#123;</span><br><span class="line">       getName : function()&#123;</span><br><span class="line">           return name;</span><br><span class="line">       &#125;,</span><br><span class="line">       setName : function(newName)&#123;</span><br><span class="line">           name = newName;</span><br><span class="line">       &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">var john = Person();</span><br><span class="line">print(john.getName());</span><br><span class="line">john.setName(&quot;john&quot;);</span><br><span class="line">print(john.getName());</span><br><span class="line"></span><br><span class="line">var jack = Person();</span><br><span class="line">print(jack.getName());</span><br><span class="line">jack.setName(&quot;jack&quot;);</span><br><span class="line">print(jack.getName());</span><br><span class="line"></span><br><span class="line">运行结果如下：</span><br><span class="line"></span><br><span class="line">default</span><br><span class="line">john</span><br><span class="line">default</span><br><span class="line">jack</span><br></pre></td></tr></table></figure>
<p>由此代码可知，john和jack都可以称为是Person这个类的实例，因为这两个实例对name这个成员的访问是独立的，互不影响的。</p>


<p>当然，除此之外，从不同的角度来看待闭包，他的作用也可以有不同的说法。</p><br><ul><br><li>闭包可以防止变量重名，保证变量不污染全局</li><br><li>闭包可以创建私有变量和私有方法</li><br><li>闭包可以….</li><br></ul><br><br><br><p>本文参考：<a href="http://blog.csdn.net/sunlylorn/article/details/6534610" target="_blank">sunlylorn的专栏</a></p>
          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://handishenniu.coding.me/blog/blog/2013/04/24/2013-04-24-cb-ie6-bugs/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lion">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="撼地神牛">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/blog/2013/04/24/2013-04-24-cb-ie6-bugs/" class="post-title-link" itemprop="https://handishenniu.coding.me/blog/page/25/index.html">IE6 bug集</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2013-04-24 08:08:00" itemprop="dateCreated datePublished" datetime="2013-04-24T08:08:00+08:00">2013-04-24</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-12-12 18:10:11" itemprop="dateModified" datetime="2018-12-12T18:10:11+08:00">2018-12-12</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/blog/categories/JavaScript/" itemprop="url" rel="index"><span itemprop="name">JavaScript</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/blog/categories/JavaScript/杂物间/" itemprop="url" rel="index"><span itemprop="name">杂物间</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <div class="history-article">本文为归档内容,原始地址在 <a href="http://www.cnblogs.com/hustskyking/archive/2013/04/24/ie6-bugs.html" target="_blank">博客园</a>.</div>

<p><strong>1.IE6的3像素偏移BUG</strong>&nbsp;&nbsp;&nbsp; 当浮动元素与非浮动元素相邻（注意这里的相邻可以是纵向的也可以是横向的）时，这个3像素的Bug就会出现，它会偏移3像素。实际表现就是两个元素之间产生了一道缝隙！解决方法很简单，将两个元素都浮动就OK了。此BUG深层的原因是非浮动元素的layout未触发，所以这里只要是能够触发layout的css都可以解决问题。</p>


<p><strong>2.IE6 双倍边距问题</strong>&nbsp;&nbsp;&nbsp; 当浮动元素设置margin边距时，边距会加倍。解决方法是给浮动元素加上display：inline属性。</p>


<p><strong>3.IE6下空标签高度问题</strong>&nbsp;&nbsp;&nbsp; 当你把标签的高度设置为0-19内的数字时，IE6会一致的显示为19px高。解决方法：给标签加上overflow：hidden。</p>


<p><strong>4.IE6图片下方有空隙产生</strong><span>&nbsp; &nbsp;css代码：</span></p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">div &#123;</span><br><span class="line">  border:1px solid red;</span><br><span class="line">  background:orange;</span><br><span class="line">&#125;</span><br><span class="line">img &#123;</span><br><span class="line">  width:276px;</span><br><span class="line">  height:110px;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<pre><span>HTML代码：</span></pre>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;</span><br><span class="line">     &lt;img src=&quot;....&quot; alt=&quot;google&quot;&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<pre>解决办法是：img｛display：block；}<span><strong>5.IE6,7失效的margin-left/right bug</strong></span><span>HTML代码：</span></pre>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class=&quot;wrap&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;cont&quot;&gt;www.hemin.cn&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<pre><span>CSS代码：</span></pre>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wrap&#123;background:#eee;border:1px solid #ccc;&#125;</span><br><span class="line">cont&#123;border-bottom:2px solid #aaa;margin:0 100px;height:30px;&#125;</span><br></pre></td></tr></table></figure>
<pre><span>解决方法：触发.warp的layout就可以了。具体的比如：给.warp加上zoom:1或者width等等。</span><span><strong>6. IE6 幽灵文本(Ghost Text bug)</strong></span>在我写本文之前，我遇到了这个bug。它相当的古怪和滑稽。一块不知哪来的重复的文本，被IE6显示在靠近原文本的下面。(译注：也可以参看<a href="http://www.positioniseverything.net/explorer/dup-characters.html" target="_blank">Explorer 6 Duplicate Characters Bug</a>获得bug演示)。我无法解决它，所以我搜索它，果然，这是另一个IE6的bug。对此有许多解决方法，但是没有一个对我的例子有效(因为网站的复杂性我无法使用其中的一些方法)。所以我使用了hack。在原文本之后增加空格看起来能解决这个问题。但是，从<a href="http://hippytechblog.blogspot.com/2009/07/ie6-ghost-text-bug.html" target="_blank">Hippy Tech Blog</a>那里了解到，问题背后的原因是由于html注释标签。IE6不能正确的渲染它。下面是他建议的解决方案列表：</pre>
<ol>
<li>使用&lt;!&mdash;[IF !IE]&gt;标签包围注释</li>
<li>移除注释</li>
<li>在前浮动上增加样式 {display:inline;}</li>
<li>在适当的浮动的div上使用负边距</li>
<li>在原文本增加额外的<nbsp;(比如10个空格) (hacky="" way)<="" li="">
</nbsp;(比如10个空格)></li></ol>
<pre><span><strong>7. 相对位置和溢出隐藏(Position Relative and Overflow Hidden)</strong></span>这个问题我遇到过很多次，当时我正在准备一个JQuery的教程，因为我使用了很多overflow hidden来达到我想要的布局。问题发生在当父元素的overflow被设置成hidden并且子元素被设置成position:relative。CSS-Trick有一个很好的例子来演示这个bug。<a href="http://snook.ca/archives/html_and_css/position_relative_overflow_ie/" target="_blank">position:relative and overflow in internet explorer</a><em>解决方法</em>为父元素增加position:relative;<span><strong>8. IE的最小高度(Min-Height for IE)</strong></span>这很简单，IE忽略min-height属性。你可以用下面的hack来修复它。感谢<a href="http://www.dustindiaz.com/min-height-fast-hack/" target="_blank">Dustin Diaz</a>。这个解决方法在IE6, Mozilla/Firefox/Gecko, Opera 7.x+, Safari1.2里都工作的很好。<em>解决方法</em></pre>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">selector &#123;</span><br><span class="line">   min-height:500px;</span><br><span class="line">   height:auto !important;</span><br><span class="line">   height:500px;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<pre><span><strong>9. Bicubic图像缩放(Bicubic Image Scaling)</strong></span>你会喜欢这个的。IE那糟糕图像缩放让你很困扰？如果你拿IE和其他浏览器比较，IE缩小的图像看起来不如其他浏览器。</pre>
<p><img src="//img.alicdn.com/tfs/TB1oyqGa_tYBeNjy1XdXXXXyVXa-300-300.png" data-original="/blogimgs/2013/04/24/2010072616324250.gif" data-source="http://pic002.cnblogs.com/img/lw19870811/201007/2010072616324250.gif" alt=""></p>
<pre><em>解决方法</em></pre>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">img &#123; -ms-interpolation-mode: bicubic;&#125;</span><br></pre></td></tr></table></figure>
<pre><strong>10.PNG透明(PNG Transparency)</strong></pre>
<pre>我猜每个人都知道这个，但我仍把它列在这里，作为以后的参考。</pre>
<pre>所以如果你想要使用透明图像并且GIF不能给你想要的质量，你会需要这个对PNG的hack。你必须意识到，如果你使用一张PNG图像作为背景，你将不能设置背景的位置。<em>解决方法</em><em>&nbsp;</em></pre>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">img &#123;</span><br><span class="line">    filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(...);</span><br><span class="line">｝</span><br></pre></td></tr></table></figure>
<pre><span></span><strong>11. IFrame透明背景 (IFrame Transparent Background)</strong></pre>
<pre>在firefox和safari里你应该不会遇到这个问题因为默认情况下，iframe的背景被设置为transparent，但是在IE里，却不是如此。你需要用到allowTransparency 属性并且加入下面的CSS代码来达成目的。<em>解决方法</em></pre>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">/* in the iframe element */</span><br><span class="line">&lt;iframe src=&quot;content.html&quot; allowtransparency=&quot;true&quot;&gt;</span><br><span class="line">&lt;/iframe&gt;</span><br><span class="line"></span><br><span class="line">/* in the iframe docuement, in this case content.html */</span><br><span class="line">body &#123;</span><br><span class="line">    background-color:transparent;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<pre><strong>12. 禁用IE默认的垂直滚动条(Disabled IE default Vertical Scroll bar)</strong></pre>
<pre>默认情况下，即使内容适合窗口大小，IE(译注：IE6/7)也会显示垂直滚动条。你可以使用overflow:auto，让滚动条只在你需要时出现。<em></em><span><strong>13. :hover伪类(:hover Pseudo Class)</strong></span>IE只支持&lt;a&gt;元素的 :hover伪类。你可以使用jQuery的hover event来达到相同效果。<em></em></pre>
<pre><strong>14. 盒模型Hack(Box Hack Model)</strong></pre>
<pre>这是IE里最热门的bug了。基本的理解是，IE计算宽度(width)的方式不同。基于w3c标准，一个元素总宽度应该是总宽度 = margin-left + border-left + padding-left + width + padding-right + border-right + margin-right但是，IE计算宽度时没有加上填充和边框：总宽度 = margin-left + width + margin-right更多的细节，请参考这个链接：<a href="http://www.456bereastreet.com/archive/200612/internet_explorer_and_the_css_box_model/" target="_blank">Internet Explorer和CSS盒模型详细解释</a><em>解决方法</em>使用w3c的标准兼容模式。IE6或者之后的版本能基于w3c的标准计算，但是你仍旧会在IE5中遇到问题。或者你可以用CSS Hack来解决这个问题。所有标准兼容的浏览器都能读取w\\idth:180px 除了IE5。</pre>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#content &#123;</span><br><span class="line">    padding:10px;</span><br><span class="line">    border:1px solid;</span><br><span class="line">    width:200px;</span><br><span class="line">    w\\idth:180px;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<pre><span><strong>15.IE bug</strong></span>（摘自：<a href="http://www.iwanna.cn/archives/2010/07/29/4780/" target="_blank" rel="noopener">http://www.iwanna.cn/archives/2010/07/29/4780/</a>）</pre>
<table>
<thead>
<tr><th width="30">&nbsp;</th><th width="120">问题</th><th width="60">浏览器</th><th width="90">DEMO</th><th width="120">解决方法</th></tr>
<tr>
<td colspan="5"><strong>Hacking Rules:&nbsp;</strong>property:all-<a class="st_tag internal_tag" title="Posts tagged with IE" href="http://www.iwanna.cn/tags/ie/" rel="noopener" target="_blank">ie</a>\9; property:gte-ie8\0;*property:lte-ie7; +property:ie7; _property:ie6;</td>

</tr>

</thead>
<tbody>
<tr>
<td>1</td>
<td>input[button | submit] 不能用 margin:0 auto; 居中</td>
<td>IE8</td>
<td><a href="http://haslayout.net/demos/No-Auto-Margin-Center-on-Buttons-Inconsistency-Demo.html" target="_blank">bug</a>&nbsp;|&nbsp;<a href="http://haslayout.net/demos/No-Auto-Margin-Center-on-Buttons-Inconsistency-Fixed-Demo-CS.html" target="_blank">fixed</a></td>
<td>为input添加width</td>

</tr>
<tr>
<td>2</td>
<td>body{overflow:hidden;}没有去掉滚动条</td>
<td>IE6/7</td>
<td><a href="http://haslayout.net/demos/Document-Scrollbars-Overflow-Inconsistency-Demo.html" target="_blank">bug</a>&nbsp;|&nbsp;<a href="http://haslayout.net/demos/Document-Scrollbars-Overflow-Inconsistency-Fixed-Demo.html" target="_blank">fixed</a></td>
<td>设置html{overflow:hidden;}</td>

</tr>
<tr>
<td>3</td>
<td>hasLayout的标签拥有高度</td>
<td>IE6/7</td>
<td><a href="http://haslayout.net/demos/Empty-Element-Height-Bug-Demo.html" target="_blank">bug</a>&nbsp;|&nbsp;<a href="http://haslayout.net/demos/Empty-Element-Height-Bug-Fixed-Demo.html" target="_blank">fixed</a></td>
<td>*height:0;_overflow:hidden;</td>

</tr>
<tr>
<td>4</td>
<td>form&gt;[hasLayout]元素有margin-left时，子元素中的[input | textarea] 出现2×margin-left</td>
<td>IE6/7</td>
<td><a href="http://haslayout.net/demos/Form-Control-Double-Margin-Bug-Demo.html" target="_blank">bug</a>&nbsp;|&nbsp;<a href="http://haslayout.net/demos/Form-Control-Double-Margin-Bug-Fixed-Demo.html" target="_blank">fixed</a></td>
<td>form &gt; [hasLayout 元素]{margin-left:宽度;}form div{*margin-left:宽度&divide;2;}</td>

</tr>
<tr>
<td>5</td>
<td>当border-width有1条&lt;边3条时被设置成dotted时，1px的边dotted显示成dashed</td>
<td>IE7</td>
<td><a href="http://haslayout.net/demos/IE7-1px-Dotted-Border-Appears-As-Dashed-Bug-Demo.html" target="_blank">bug</a>&nbsp;|&nbsp;<a href="http://haslayout.net/demos/IE7-1px-Dotted-Border-Appears-As-Dashed-Bug-Fixed-Demo.html" target="_blank">fixed</a></td>
<td>不在同一个元素上使用不同宽度的 dotted</td>

</tr>
<tr>
<td>6</td>
<td>当子元素有position:relative的时候，父元素设置overflow:[hidden|auto]相当于给子元素设置了position:visible;</td>
<td>IE6/7</td>
<td><a href="http://haslayout.net/demos/relative-overflow-failure-bug-demo.html" target="_blank">bug</a>&nbsp;|&nbsp;<a href="http://haslayout.net/demos/relative-overflow-failure-bug-demo-fixed.html" target="_blank">fixed</a></td>
<td>给父元素设置position:relative;</td>

</tr>
<tr>
<td>7</td>
<td>:hover伪类不能改变有position:absolute的子级元素的left/top值</td>
<td>IE7</td>
<td><a href="http://haslayout.net/demos/ie7-broken-hover-absolute-bug-demo.html" target="_blank">bug</a>&nbsp;|&nbsp;<a href="http://haslayout.net/demos/ie7-broken-hover-absolute-bug-demo-fixed.html" target="_blank">fixed</a></td>
<td>把top/left的值设置成除0%外的所有百分值；或添加一个margin-[所有方向]除0外的所有值，包括0%</td>

</tr>
<tr>
<td>8</td>
<td>:focus + selector {} 选择器失效</td>
<td>IE8</td>
<td><a href="http://haslayout.net/demos/ignored-focus-bug-demo.html" target="_blank">bug</a>&nbsp;|&nbsp;<a href="http://haslayout.net/demos/ignored-focus-bug-demo-fixed.html" target="_blank">fixed</a></td>
<td>在失效选择器后面添加一个空选择器, :focus{}</td>

</tr>
<tr>
<td>9</td>
<td>列表中混乱的浮动：在list中浮动图片时，图片出现溢出正常位置；或没有list-style</td>
<td>IE8</td>
<td><a href="http://haslayout.net/demos/image-float-bullet-chaos-demo.html" target="_blank">bug</a>&nbsp;|&nbsp;<a href="http://haslayout.net/demos/image-float-bullet-chaos-demo-fixed.html" target="_blank">fixed</a></td>
<td>用背景图片替换list-style</td>

</tr>
<tr>
<td>10</td>
<td>th 不会自动继承上级元素的 text-align</td>
<td>IE8</td>
<td><a href="http://haslayout.net/demos/non-inherited-th-text-align-bug-demo.html" target="_blank">bug</a>&nbsp;|&nbsp;<a href="http://haslayout.net/demos/non-inherited-th-text-align-bug-demo-fixed.html" target="_blank">fixed</a></td>
<td>给th添加text-align:inherit; (base.<a class="st_tag internal_tag" title="Posts tagged with CSS" href="http://www.iwanna.cn/tags/css/" rel="noopener" target="_blank">css</a>中已包含)</td>

</tr>
<tr>
<td>11</td>
<td>样式(包括link/style/@import(link)) 最多允许个为是：32</td>
<td>IE6-8</td>
<td>─ 常识</td>
<td>99.99%的情况下，不会遇到</td>

</tr>
<tr>
<td>12</td>
<td>:hover 时若background-color为#fff, 失效</td>
<td>IE7</td>
<td><a href="http://haslayout.net/demos/hover-white-background-ignore-bug.html" target="_blank">bug</a>&nbsp;|&nbsp;<a href="http://haslayout.net/demos/hover-white-background-ignore-bug-fixed-demo.html" target="_blank">fixed</a></td>
<td>把background-color改成background。或者，非#fff || #ffffff</td>

</tr>
<tr>
<td>13</td>
<td>忽略"&gt;"后有注释的选择器：selector&gt; /**/ selector{}</td>
<td>IE6</td>
<td><a href="http://haslayout.net/demos/ie7-child-selector-comment-bug-demo.html" target="_blank">bug</a>&nbsp;|&nbsp;<a href="http://haslayout.net/demos/ie7-child-selector-comment-bug-demo.html" target="_blank">fixed</a></td>
<td>[<a href="http://haslayout.net/css/IE7-Child-Selector-Comment-Bug" target="_blank">官方误判</a>] 这个bug是IE6 BUG</td>

</tr>
<tr>
<td>14</td>
<td>* html</td>
<td>IE6</td>
<td>─ HACK</td>
<td>只对IE6有效</td>

</tr>
<tr>
<td>15</td>
<td>PNG图片中的颜色和背景颜色的值相同，但显示不同</td>
<td>IE6-7</td>
<td><a href="http://haslayout.net/demos/png-color-mismatch-demo.html" target="_blank">bug</a>&nbsp;|&nbsp;<a href="http://haslayout.net/demos/png-color-mismatch-demo-fixed.html" target="_blank">fixed</a></td>
<td>利用&nbsp;<a href="http://pmt.sourceforge.net/pngcrush/" target="_blank">pngcrush</a>&nbsp;去除图片中的 Gamma profiles</td>

</tr>
<tr>
<td>16</td>
<td>margin:0 auto; 不能让block元素水平居中</td>
<td>IE6-8</td>
<td><a href="http://haslayout.net/demos/no-auto-margin-center-pseudo-bug-demo.html" target="_blank">bug</a>&nbsp;|&nbsp;<a href="http://haslayout.net/demos/no-auto-margin-center-pseudo-bug-demo-fixed.html" target="_blank">fixed</a></td>
<td>给block元素添加一个width</td>

</tr>
<tr>
<td>17</td>
<td>使用伪类 :first-line | :first-letter, 属性的值中出现!important 会使属性失效</td>
<td>IE8</td>
<td><a href="http://haslayout.net/demos/ie8-first-line-important-bug.html" target="_blank">bug</a>&nbsp;|&nbsp;<a href="http://haslayout.net/demos/ie8-first-line-important-bug-fixed.html" target="_blank">fixed</a></td>
<td>!important is evil, don"t use it anymore</td>

</tr>
<tr>
<td>18</td>
<td>:first-letter 失效</td>
<td>IE6</td>
<td><a href="http://haslayout.net/demos/ie6-first-letter-ignore-bug.html" target="_blank">bug</a>&nbsp;|&nbsp;<a href="http://haslayout.net/demos/ie6-first-letter-ignore-bug-fixed.html" target="_blank">fixed</a></td>
<td>把 :first-letter 移到离{}最近的地方，如 h1, p:first-letter{}，而非 p:first-letter h1{}</td>

</tr>
<tr>
<td>19</td>
<td>Position:absolute元素中，a display:block, 在非:hover时只有文本可点击</td>
<td>IE6/7</td>
<td><a href="http://haslayout.net/demos/partial-click-v2-demo.html" target="_blank">bug</a>&nbsp;|&nbsp;<a href="http://haslayout.net/demos/partial-click-v2-demo-fixed.html" target="_blank">fixed</a></td>
<td>给a添加background, 如果背景透明，使用background:url("任何页面中已经缓存的文件链接")，不推荐background：url(#)[<a href="http://haslayout.net/css/Partial-Click-Bug-v2" target="_blank">官方的解决方法</a>]，因为会增加一下HTTP请求</td>

</tr>
<tr>
<td>20</td>
<td>float列表元素不水平对齐：li不设置float，a设置display:block;float:[方向]，li不水平对齐</td>
<td>IE6/7</td>
<td><a href="http://haslayout.net/demos/staircase-bug-demo.html" target="_blank">bug</a>&nbsp;|&nbsp;<a href="http://haslayout.net/demos/staircase-bug-demo-fixed.html" target="_blank">fixed</a></td>
<td>给li设置display:inline 或 float:[方向]</td>

</tr>
<tr>
<td>21</td>
<td>dt, dd, li 背景失效</td>
<td>IE6</td>
<td><a href="http://haslayout.net/demos/disappearing-list-background-bug-demo.html" target="_blank">bug</a>&nbsp;|&nbsp;<a href="http://haslayout.net/demos/disappearing-list-background-bug-demo-fixed.html" target="_blank">fixed</a></td>
<td>dt, dd, li{position:relative;} (base.<a class="st_tag internal_tag" title="Posts tagged with CSS" href="http://www.iwanna.cn/tags/css/" rel="noopener" target="_blank">css</a>中已包含)</td>

</tr>
<tr>
<td>22</td>
<td>&lt;noscript /&gt;元素的样式在启用javascript的情况下显示了样式</td>
<td>IE6-8</td>
<td><a href="http://haslayout.net/demos/noscript-ghost-bug-demo.html" target="_blank">bug</a>&nbsp;|&nbsp;<a href="http://haslayout.net/demos/noscript-ghost-bug-demo-fixed.html" target="_blank">fixed</a></td>
<td>利用js给&lt;noscript /&gt;添加display:none;</td>

</tr>
<tr>
<td>23</td>
<td>使用filter处理的透明背景图片的透明部分不可点</td>
<td>IE6-8</td>
<td><a href="http://haslayout.net/demos/no-transparency-click-bug-demo.html" target="_blank">bug</a>&nbsp;|&nbsp;<a href="http://haslayout.net/demos/no-transparency-click-bug-demo-fixed.html" target="_blank">fixed</a></td>
<td>把background:none变成background:url("链接")，链接到本身和图片之外的任何文件</td>

</tr>
<tr>
<td>24</td>
<td>li内元素偏离 baseline 向下拉</td>
<td>IE8</td>
<td><a href="http://haslayout.net/demos/list-drop-shift-bug-demo.html" target="_blank">bug</a>&nbsp;|&nbsp;<a href="http://haslayout.net/demos/list-drop-shift-bug-demo-fixed.html" target="_blank">fixed</a></td>
<td>给li设置display:inline 或 float:[方向]</td>

</tr>
<tr>
<td>25</td>
<td>列表中li的list-style不显示</td>
<td>IE6/7</td>
<td><a href="http://haslayout.net/demos/no_li_ol_bullets_demo.html" target="_blank">bug</a>&nbsp;|&nbsp;<a href="http://haslayout.net/demos/no_li_ol_bullets_demo_fixed.html" target="_blank">fixed</a></td>
<td>给li添加margin-left，留空间来显示（不要加在ul上）</td>

</tr>
<tr>
<td>26</td>
<td>图片不能垂直居中</td>
<td>IE6/7</td>
<td><a href="http://haslayout.net/css/No-line-height-Vertical-Center-on-Images-Bug" target="_blank">bug/fixed</a></td>
<td>添加一个空标签，并赋给"Layout", 比如display:inline-block;</td>

</tr>
<tr>
<td>27</td>
<td>不能自定义指针样式</td>
<td>IE6-8</td>
<td><a href="http://haslayout.net/demos/cursor/a/demo.html" target="_blank">bug</a>&nbsp;|&nbsp;<a href="http://haslayout.net/demos/cursor/a/demo_fixed.html" target="_blank">fixed</a></td>
<td>给指针文件设置绝对路径</td>

</tr>
<tr>
<td>28</td>
<td>背景溢出，拖动滚动条后显示正常</td>
<td>IE6</td>
<td><a href="http://haslayout.net/demos/backgroundleak_demo.html" target="_blank">bug</a>&nbsp;|&nbsp;<a href="http://haslayout.net/demos/backgroundleak_demo_ls_fixed.html" target="_blank">fixed</a></td>
<td>给父元素添加overflow:hidden防止溢出，并赋予hasLayout,如果添加_zoom:1;</td>

</tr>
<tr>
<td>29</td>
<td>高度超过height定义的高</td>
<td>IE6</td>
<td><a href="http://haslayout.net/css/Expanding-Height-Bug" target="_blank">bug/fixed</a></td>
<td>添加_overflow:hidden;(推荐)或者_font-size:0;</td>

</tr>
<tr>
<td>30</td>
<td>宽度超过width定义的宽</td>
<td>IE6</td>
<td><a href="http://haslayout.net/css/Expanding-Width-Bug" target="_blank">bug/fixed</a></td>
<td>添加_overflow:hidden; 或使用alice v3 中的 .sl-word-break 类（table用.sl-table-break）</td>

</tr>
<tr>
<td>31</td>
<td>双倍边距</td>
<td>IE6</td>
<td>─ 常识</td>
<td>添加display:inline到float元素中</td>

</tr>
<tr>
<td>32</td>
<td>margin负值隐藏：hasLayout的父元素内的非hasLayout元素，使用负边距时，超出父元素部分不可见</td>
<td>IE6/7</td>
<td><a href="http://haslayout.net/css/Negative-Margin-Bug" target="_blank">bug/fixed</a></td>
<td>去掉父元素的hasLayout；或者赋hasLayout给子元素,并添加position:relative;</td>

</tr>
<tr>
<td>33</td>
<td>给两个浮动元素的某中一个的文字设定为斜体，另一个元素下拉在有斜体文字元素的下面</td>
<td>IE6</td>
<td><a href="http://haslayout.net/css/Italics-Float-Bug" target="_blank">bug/fixed</a></td>
<td>给有斜体文字的元素添加overflow:hidden;</td>

</tr>
<tr>
<td>35</td>
<td>3px 间隔：在float元素后的元素，会有3px间隔</td>
<td>IE6</td>
<td><a href="http://haslayout.net/css/3px-Gap-Bug-aka-Text-Jog-Bug" target="_blank">bug/fixed</a></td>
<td>因为是确切的3px，所以，用\暴力破解"吧，比如_margin-left:-3px;</td>

</tr>
<tr>
<td>35</td>
<td>text-align 影响块级元素</td>
<td>IE6/7</td>
<td><a href="http://haslayout.net/css/Text-Align-Bug" target="_blank">bug/fixed</a></td>
<td>整理你的float；或者分开设置text-alig</td>

</tr>

</tbody>

</table>
<pre>总之万恶的IE6是这么的"与众不同"。以后我会持续更新这篇日志，记录更多的BUG，直到IE6消失！本文转自：<a href="http://www.cnblogs.com/Kampfer/archive/2010/07/25/1784723.html" target="_blank">Kampfer的记事本</a></pre>


          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://handishenniu.coding.me/blog/blog/2013/04/22/2013-04-22-cb-make-a-tree/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lion">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="撼地神牛">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/blog/2013/04/22/2013-04-22-cb-make-a-tree/" class="post-title-link" itemprop="https://handishenniu.coding.me/blog/page/25/index.html">JS动态构建一棵目录树</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2013-04-22 11:17:00" itemprop="dateCreated datePublished" datetime="2013-04-22T11:17:00+08:00">2013-04-22</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-12-12 18:10:11" itemprop="dateModified" datetime="2018-12-12T18:10:11+08:00">2018-12-12</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/blog/categories/JavaScript/" itemprop="url" rel="index"><span itemprop="name">JavaScript</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/blog/categories/JavaScript/杂物间/" itemprop="url" rel="index"><span itemprop="name">杂物间</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <div class="history-article">本文为归档内容,原始地址在 <a href="http://www.cnblogs.com/hustskyking/archive/2013/04/22/make-a-tree.html" target="_blank">博客园</a>.</div>

<p>在使用frameset布局的时候，经常会用到目录树，我们可以把一棵树写死，但是更多的情况是，这棵树需要随时被改动，所以我们期望的是他能够被动态的构建。</p><br><p>MVC，算是了解一点，那本文就把这棵树根据M-V-C给拆开分解吧。</p><br><p><img src="//img.alicdn.com/tfs/TB1oyqGa_tYBeNjy1XdXXXXyVXa-300-300.png" data-original="/blogimgs/2013/04/22/22110251-818c9f213e1241cf8c88b5a769638ede.png" data-source="http://images.cnitblog.com/blog/387325/201304/22110251-818c9f213e1241cf8c88b5a769638ede.png" alt=""></p><br><p><a title="DEMO" href="http://qianduannotes.sinaapp.com/test/tree.html" target="_blank">点击链接demo→</a></p><br><p>下面就来看看这棵树是怎么构建的。　</p><br><p>　</p><br><h3>Module [数据层]</h3><br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">var tree = &#123;</span><br><span class="line">            &quot;id&quot;: 0,</span><br><span class="line">            &quot;a1&quot;: &#123;</span><br><span class="line">                &quot;id&quot;: 1,</span><br><span class="line">                &quot;name&quot;: &quot;a1&quot;,</span><br><span class="line">                &quot;children&quot;: &#123;</span><br><span class="line">                    &quot;b1&quot;: &quot;b1_1&quot;,</span><br><span class="line">                    &quot;b2&quot;: &quot;b1_2&quot;,</span><br><span class="line">                    &quot;b3&quot;: &quot;b1_3&quot;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;a2&quot;: &#123;</span><br><span class="line">                &quot;id&quot;: 1,</span><br><span class="line">                &quot;name&quot;: &quot;a2&quot;,</span><br><span class="line">                &quot;children&quot;: &#123;&#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;a3&quot;: &#123;</span><br><span class="line">                &quot;id&quot;: 1,</span><br><span class="line">                &quot;name&quot;: &quot;a3&quot;,</span><br><span class="line">                &quot;children&quot;: &#123;</span><br><span class="line">                    &quot;b1&quot;: &quot;b3_1&quot;,</span><br><span class="line">                    &quot;b2&quot;: &quot;b3_2&quot;,</span><br><span class="line">                    &quot;b3&quot;: &quot;b3_3&quot;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br></pre></td></tr></table></figure><br><br><p>这是一颗两层的目录树，用ID来表示层级关系，name来表示改层的名字（也就是节点Text内容吧）。</p>


<h3>Control [控制层]</h3>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">var Tree = function ( module )&#123;</span><br><span class="line">    function createNodeList( obj ) &#123;</span><br><span class="line">        //创建ul节点和documentFragmeng中间变量</span><br><span class="line">        var n = document.createElement(&quot;ul&quot;),</span><br><span class="line">            docfrag = document.createDocumentFragment();</span><br><span class="line"></span><br><span class="line">        //判断obj是根节点还是孩子节点</span><br><span class="line">        if(obj.id == 0) &#123;</span><br><span class="line">            n.setAttribute(&quot;class&quot;, &quot;tree_0&quot;);</span><br><span class="line"></span><br><span class="line">            for(var key in obj) &#123;</span><br><span class="line">                if(key == &quot;id&quot;) continue;</span><br><span class="line">                //将节点插入</span><br><span class="line">                var c = document.createElement(&quot;li&quot;),</span><br><span class="line">                    span = document.createElement(&quot;span&quot;);</span><br><span class="line">                span.appendChild(document.createTextNode( obj[key].name ));</span><br><span class="line">                c.appendChild(span);</span><br><span class="line">                docfrag.appendChild( c );</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;else if(obj.id &amp;&amp; obj.id == 1) &#123;</span><br><span class="line">            n.setAttribute(&quot;class&quot;, &quot;tree_1&quot;);</span><br><span class="line"></span><br><span class="line">            for(var key in obj) &#123;</span><br><span class="line">                if(key == &quot;id&quot; || key == &quot;name&quot; || !obj.children) continue;</span><br><span class="line">                for( var item in obj.children)&#123;</span><br><span class="line">                    //将节点插入</span><br><span class="line">                    var c = document.createElement(&quot;li&quot;);</span><br><span class="line">                    c.appendChild(document.createTextNode( obj.children[item] ));</span><br><span class="line">                    docfrag.appendChild( c );</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        n.appendChild( docfrag );</span><br><span class="line">        //返回开始构建的ul节点</span><br><span class="line">        return n;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //隐藏及显示 工具函数</span><br><span class="line">    function toggle(c)&#123;</span><br><span class="line">        c.style.display = ((c.style.display == &quot;none&quot;) ? &quot;&quot; : &quot;none&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function createTree( obj ) &#123;</span><br><span class="line">        var root, child, count = 0;</span><br><span class="line"></span><br><span class="line">        root = createNodeList( obj );</span><br><span class="line">        for(var key in obj)&#123;</span><br><span class="line">            if(obj[key] == &quot;id&quot; || !obj[key].children) continue;</span><br><span class="line">            child = createNodeList(obj[key]);</span><br><span class="line">            root.children[count].appendChild( child );</span><br><span class="line">            //count来判断插入的位置</span><br><span class="line">            count++;</span><br><span class="line">        &#125;</span><br><span class="line">        return root;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    var T = createTree(module);</span><br><span class="line">    var list = T.children;</span><br><span class="line">    for(var i = 0, len = list.length; i &lt; len; i++)&#123;</span><br><span class="line">        list[i].getElementsByTagName(&quot;span&quot;)[0].onclick = function()&#123;</span><br><span class="line">            var obj = this.nextSibling;</span><br><span class="line">            toggle(obj);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return T;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里边创建了三个函数，其中</p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">createNodeList() //适用于构建一个树子节点</span><br></pre></td></tr></table></figure>
<p>其中使用documentFragment作为一个节点缓存器，先把节点放置到documentFragment中，然后统一插入到ul，这也是比较常用的使用方式。</p>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">createTree() //构建一棵树</span><br></pre></td></tr></table></figure>
<p>基本整棵树的构建就是分为这两步，前者负责创建一个子节点，后者构建一棵树。</p><br><p>在这颗树中绑定了click事件，让其可以折叠，当然也可以在Tree这个类里绑定更多的方法，这个就靠自己发挥了。</p>


<h3>View [视图层]</h3>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">window.onload = function()&#123;</span><br><span class="line">    var T = new Tree(tree);</span><br><span class="line">    document.getElementsByTagName(&quot;body&quot;)[0].appendChild(T);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>整棵树的构建，主要用到的是DOM元素的处理，这个必须牢牢掌握！</p>
          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://handishenniu.coding.me/blog/blog/2013/04/22/2013-04-22-cb-category-of-picture/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lion">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="撼地神牛">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/blog/2013/04/22/2013-04-22-cb-category-of-picture/" class="post-title-link" itemprop="https://handishenniu.coding.me/blog/page/25/index.html">最受欢迎的几种图片格式及其常见用法</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2013-04-22 06:18:00" itemprop="dateCreated datePublished" datetime="2013-04-22T06:18:00+08:00">2013-04-22</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-12-12 18:10:11" itemprop="dateModified" datetime="2018-12-12T18:10:11+08:00">2018-12-12</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/blog/categories/剪贴板/" itemprop="url" rel="index"><span itemprop="name">剪贴板</span></a></span>

                
                
                  ，
                
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/blog/categories/剪贴板/杂物间/" itemprop="url" rel="index"><span itemprop="name">杂物间</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <div class="history-article">本文为归档内容,原始地址在 <a href="http://www.cnblogs.com/hustskyking/archive/2013/04/22/category-of-picture.html" target="_blank">博客园</a>.</div>

<p><span>　　从某种程度上说，判断一个网页设计师是否优秀，可以从其在WEB开发（或网页设计）中是否合理的采用各种图片格式得出结论。事实上，或许所有人都知道图片存在GIF,JPG和PNG等格式，但并非所有人都知道它们之间的具体区别和使用技巧。</span><span>　　接下来，将给大家介绍：WEB开发中几种最受欢迎图片格式的前世今生以及如何正确的使用它们。</span></p><br><h3>JPEG</h3><br><p><span>　　JPEG格式是一种大小与质量相平衡的压缩图片格式。通俗一点讲，就是：高的压缩比=低的图片质量=小的文件大小。反之，低的压缩比=高的图片质量=大的文件大小。由于JPEG文件无法保持100 ％的原始图像的像素数据，所以它不被认为是一种无损图像格式。</span></p><br><p><strong>用途：</strong><span>　　由于这种极其敏感的平衡特性，JPEG非常适合被应用在那些允许轻微失真的像素色彩丰富的图片（照片）场合。反之，JPEG格式图片并不适合做简单色彩（色调少）的图片，比如LOGO，各种小图标（ICONS）。</span></p>


<p></p><h3>GIF</h3><p></p>
<p><span>　　GIF格式，是为使图片能够应用在在线（online）应用程序上所特别开发的图片格式。Gif，有时也被成为\Giff”，是一种无损，8位图片格式。\无损”是指100%的保持原始图片的像素数据信息。专业名词\8位”是指，所能表现的颜色深度&mdash;&mdash;一个8位图像仅最多只能支持256种不同颜色（一个多余256种颜色的图片若用gif图片保存会出现失真）。</span></p><br><p><strong>用途：</strong><span>　　由于8位颜色深度的限制，Gif不适合应用于各种色彩过于丰富的照片存储场合。但它却非常适合应用在以下场合：</span></p><br><ul><br><li><span>Logo</span></li><br><li><span>小图标（Icon）</span></li><br><li><span>用于布局的图片（例如某个布局角落，边框等等）</span></li><br><li><span>仅包含不超过256种色彩的简单，小型图片场合</span></li><br><br></ul><br><p><strong>透明特性：</strong><span>　　GIF支持基本的透明特性，这意味着你能够使图片的某些像素\不可见”。在其被放置到网页中时，我们就可以看到通过这些不可见区域看到此图片后面的背景颜色（图片）。此特性非常有用：如果你需要将某个gif图片的内容置于所有图片的上层，你可以将其设置为透明。</span></p><br><p><strong>压缩特性：</strong><span>　　GIF格式采用LZW算法进行压缩，此算法是Unisys申请的一项专利。在很久很久之前，如果你想使用GIF格式，那么就意味着你需要向Unisys付费申请专利许可。不过值得高兴的是，此项专利技术已于2003年6月20日过期，我们现在可以免费的使用GIF了！</span></p><br><p><strong>隔行扫描：</strong><span>　　GIF同时也支持隔行扫描。隔行扫描能够令图片在浏览器中更快的加载和显示。此特性对于那些慢网速的浏览者来说尤其实用。</span></p><br><p><strong>动画GIF：</strong><span>　　一个动态的GIF文件，是由若干帧图片所联结而成的动态图片。在显示时，这些动态帧被反复的绘制读取出来从而形成了简单的动画效果。合理的运用GIF动画能够为网页增添动静结合的效果，而过度的使用则会使网页杂乱无章。</span></p>


<p></p><h3><strong>PNG</strong></h3><p></p>
<p><span>　　PNG，读\ping”，初始时被作为GIF的免费替代格式所开发，采用公共专利压缩算法。PNG格式也是一种无损压缩，但与GIF格式不同的是，PNG同时支持8位和24位的图像。</span></p><br><p><strong>8位PNG图像：</strong><span>　　一个8位PNG图片，支持透明背景且像素颜色不能超过256种。除了压缩算法不同之外，此8位PNG格式与GIF格式极其相似；</span></p><br><p><strong>用途：</strong><span>　　8位PNG图片的用途与GIF格式基本相同，</span></p><br><ul><br><li><span>Logo</span></li><br><li><span>小图标（Icon）</span></li><br><li><span>用于布局的图片（例如某个布局角落，边框等等）</span></li><br><li><span>仅包含不超过256种色彩的简单，小型图片场合</span></li><br><br></ul><br><br><br><p><strong>24位PNG图像：</strong><span>　　24位PNG，支持160万种不同的像素颜色且支持Alpha透明效果，这就意味着，无论透明度设置为多少，PNG图片均能够与背景很好的融合在一起。</span></p><br><p><strong>对PNG的支持：</strong><span>　　由于PNG格式的广泛使用和开发者更加重视网页的WEB标准，不同浏览器对PNG的支持就显得相当重要了。不过，幸运的是，目前市场上主流的浏览器对PNG格式都有很好的支持，这包括：IE*, Firefox, Safari, Opera, and Konqueror。</span><span>　　但不幸的是，IE6及IE6以下的浏览器对PNG透明背景的支持并不好。不过我们仍可以通过其他方法来解决这个问题，详情请查看如何在IE6中正常显示透明PNG。</span></p>


          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/blog/page/24/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/blog/">1</a><span class="space">&hellip;</span><a class="page-number" href="/blog/page/24/">24</a><span class="page-number current">25</span><a class="page-number" href="/blog/page/26/">26</a><span class="space">&hellip;</span><a class="page-number" href="/blog/page/28/">28</a><a class="extend next" rel="next" href="/blog/page/26/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Lion</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/blog/archives/">
                
                    <span class="site-state-item-count">273</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/blog/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">84</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/blog/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">215</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          

          

          

          
          

          
            
          
          

        </div>
      </div>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Lion</span>

  

  
</div>









        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv" title="总访客量">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
    </span>
  

  
    <span class="site-pv" title="总访问量">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
    </span>
  
</div>









        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script src="/blog/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script src="/blog/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script src="/blog/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script src="/blog/js/src/utils.js?v=6.6.0"></script>

  <script src="/blog/js/src/motion.js?v=6.6.0"></script>



  
  

  

  


  <script src="/blog/js/src/bootstrap.js?v=6.6.0"></script>



  



  











  

  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/blog/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  

  

  
  

  

  

  

  

  

  

  <script src="/blog/js/src/music/aplayer.js?v=6.6.0"></script>
  <script src="/blog/js/src/music/init.js?v=6.6.0"></script>
</body>
</html>
